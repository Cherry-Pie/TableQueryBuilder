<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>jarboe by Cherry-Pie</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="//code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.3/styles/railscasts.min.css">
    
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.2/jquery.min.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.3/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    
    <style>
    .tabs-left>.nav-pills, .tabs-left>.nav-tabs {
        float: left;
        margin-right: 19px;
        border-right: 1px solid #ddd;
    }
    ul.nav.p-abs {
        position: absolute;
    }
    </style>
  </head>
  <body>
    <div class="wrapper" style="width: 100%;padding: 60px;">
      <header>
        <h1 class="header">jarboe</h1>
        <p class="header"></p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/Cherry-Pie/TableQueryBuilder/zipball/master">Download ZIP</a></li>
          <li class="download"><a class="buttons" href="https://github.com/Cherry-Pie/TableQueryBuilder/tarball/master">Download TAR</a></li>
          <li><a class="buttons github" href="https://github.com/Cherry-Pie/TableQueryBuilder">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/Cherry-Pie">Cherry-Pie</a></p>


      </header>
      
      <div id="content">

<div class="well well-sm">
<h3 class="text-primary">Инсталлим:</h3>
                    

<ol>

<li>
В <code>app/config/database.php</code> заменить на:
<pre><code class="php hljs">
<span class="hljs-comment">//</span>
<span class="hljs-string">'fetch'</span> =&gt; PDO::FETCH_ASSOC,
<span class="hljs-comment">//</span>
</code>
</pre>
</li>

<li>
    В <code>app/config/app.php</code> вписать следующее:<br>
<pre><code class="php hljs">
<span class="hljs-comment">//</span>
<span class="hljs-string">'providers'</span> =&gt; <span class="hljs-keyword">array</span>(
    <span class="hljs-comment">// ...</span>
    <span class="hljs-string">'Cartalyst\Sentry\SentryServiceProvider'</span>,
    <span class="hljs-string">'Intervention\Image\ImageServiceProvider'</span>,
    <span class="hljs-string">'Radic\BladeExtensions\BladeExtensionsServiceProvider'</span>,
    <span class="hljs-string">'Spatie\Glide\GlideServiceProvider'</span>,
    <span class="hljs-string">'Yaro\Mecha\MechaServiceProvider'</span>,
    <span class="hljs-comment">// ...</span>
),
<span class="hljs-string">'aliases'</span> =&gt; <span class="hljs-keyword">array</span>(
    <span class="hljs-comment">// ...</span>
    <span class="hljs-string">'Sentry'</span> =&gt; <span class="hljs-string">'Cartalyst\Sentry\Facades\Laravel\Sentry'</span>,
    <span class="hljs-string">'Image'</span> =&gt; <span class="hljs-string">'Intervention\Image\Facades\Image'</span>,
    <span class="hljs-string">'GlideImage'</span> =&gt; <span class="hljs-string">'Spatie\Glide\GlideImageFacade'</span>,
    <span class="hljs-string">'Mecha'</span> =&gt; <span class="hljs-string">'Yaro\Mecha\Facades\Mecha'</span>,
    <span class="hljs-comment">// ...</span>
),
<span class="hljs-comment">//</span>
</code>
</pre>

</li>

<li>
    Запустить артизаном:<br>
<pre><code class="shell hljs java">
php artisan migrate --<span class="hljs-keyword">package</span>=cartalyst/sentry
php artisan config:publish cartalyst/sentry
php artisan config:publish intervention/image
php artisan config:publish yaro/laravel-glide
php artisan asset:publish yaro/mecha
<span class="hljs-comment">// или если сабмодуль</span>
php artisan migrate --path=<span class="hljs-string">"workbench/yaro/table-builder/vendor/cartalyst/sentry/src/migrations"</span>  --<span class="hljs-keyword">package</span>=cartalyst/sentry
php artisan config:publish --path=<span class="hljs-string">"workbench/yaro/table-builder/vendor/cartalyst/sentry/src/config"</span> cartalyst/sentry
php artisan config:publish --path=<span class="hljs-string">"workbench/yaro/table-builder/vendor/intervention/image/src/config"</span> intervention/image
php artisan config:publish --path=<span class="hljs-string">"workbench/yaro/table-builder/vendor/yaro/laravel-glide/src/config"</span> spatie/laravel-glide
php artisan asset:publish --path=<span class="hljs-string">"workbench/yaro/table-builder/vendor/yaro/mecha/public"</span> yaro/mecha
</code>
</pre>
</li>

<li>
    Правим конфиг <code>app/config/packages/spatie/laravel-glide/config.php</code><br>
<pre><code class="php hljs">
<span class="hljs-comment">//...</span>
<span class="hljs-string">'source'</span> =&gt; [
    <span class="hljs-string">'path'</span> =&gt; public_path(),
],
<span class="hljs-comment">//...</span>
<span class="hljs-string">'cache'</span> =&gt; [
    <span class="hljs-string">'path'</span> =&gt; public_path() .<span class="hljs-string">'/glidecache'</span>,
],
<span class="hljs-comment">//...</span>
</code>
</pre>
</li>

<li>
    Потом это артизаном (на все соглашаемся, если чистая лара):<br>
<pre><code class="shell hljs css">
<span class="hljs-tag">php</span> <span class="hljs-tag">artisan</span> <span class="hljs-tag">tb</span><span class="hljs-pseudo">:prepare</span>
</code>
</pre></li>

<li>
    Потом делаем себе юзера (или суперюзера) для входа в админ-панель:<br>
<pre><code class="shell hljs sql">
php artisan tb:<span class="hljs-operator"><span class="hljs-keyword">create</span>-admin-<span class="hljs-keyword">user</span>
php artisan tb:<span class="hljs-keyword">create</span>-superuser
</span></code>
</pre></li>


<li>
    Копим в самый верх <code>/app/routes.php</code>:<br>
<pre><code class="php hljs">
<span class="hljs-comment">//</span>
Route::pattern(<span class="hljs-string">'id'</span>, <span class="hljs-string">'[0-9]+'</span>);
Route::pattern(<span class="hljs-string">'slug'</span>, <span class="hljs-string">'[a-z0-9-]+'</span>);

<span class="hljs-keyword">if</span> (file_exists(app_path() .<span class="hljs-string">'/routes_dev.php'</span>)) {
    <span class="hljs-keyword">include</span> app_path() .<span class="hljs-string">'/routes_dev.php'</span>;
}
<span class="hljs-keyword">include</span> app_path() .<span class="hljs-string">'/routes_backend.php'</span>;
</code>
</pre></li>

<li>
    Если ставили дерево, то идем в <code>HomeController.php</code> и экстендим его (как и все классы, в которых нужны ноды дерева):<br>
<pre><code class="php hljs">
<span class="hljs-preprocessor">&lt;?php</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HomeController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Yaro</span>\<span class="hljs-title">TableBuilder</span>\<span class="hljs-title">TreeController</span> 
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showPage</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$this</span>-&gt;node-&gt;title .<span class="hljs-string">' @ '</span>. <span class="hljs-variable">$this</span>-&gt;node-&gt;getUrl();
    } <span class="hljs-comment">// end showPage</span>
}
</code>
</pre></li>

</ol>  


</div>
<div class="well well-sm">
<h3 class="text-primary">Конфиги:</h3>
                    
<div class="bs-example">
На текущий момент мы располагаем четырьмя конфигами, которые находятся в <code>app/config/packages/yaro/table-builder</code>.
</div>          
<br>
<div class="jarviswidget jarviswidget-color-blueDark" id="wid-id-10" data-widget-colorbutton="false" data-widget-editbutton="false" data-widget-togglebutton="false" data-widget-deletebutton="false" data-widget-fullscreenbutton="false" data-widget-custombutton="false" data-widget-sortable="false" role="widget" style="">
    <header role="heading">
        <span class="widget-icon"> <i class="fa fa-lg fa-fw fa-cog"></i> </span>
        <h2>Описание конфигов</h2>
        <span class="jarviswidget-loader"><i class="fa fa-refresh fa-spin"></i></span>
    </header>

    <!-- widget div-->
    <div role="content">

        <!-- widget content -->
        <div class="widget-body no-padding">

            <div class="panel-group smart-accordion-default" id="accordion-2">
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title"><a data-toggle="collapse" data-parent="#accordion-2" href="#collapseOne-1" class="collapsed"> <i class="fa fa-fw fa-plus-circle txt-color-green"></i> <i class="fa fa-fw fa-minus-circle txt-color-red"></i> admin.php </a></h4>
                    </div>
                    <div id="collapseOne-1" class="panel-collapse collapse" style="height: 0px;">
                        <div class="panel-body">
                            <dl class="dl-horizontal">
                              <dt>uri</dt>
                              <dd>Сегмент URL для обозначения зоны админ-панели (меняем только если это требование проекта).</dd>
                              <dt>user_name</dt>
                              <dd>Имя аккаунта для отображения в админке.</dd>
                              <dt>user_image</dt>
                              <dd>Аватарка аккаунта для отображения в админке.</dd>
                              <dt>yandex_api_translation_key</dt>
                              <dd>API ключ от Yandex Translate (необходим для использования <code>TableBuilder::translate()</code>).</dd>
                              <dt>menu</dt>
                              <dd>Содержит массив, по которому строится навигационное меню админ-панели.</dd>
                            </dl>
                            
<pre><code class="php hljs">
<span class="hljs-string">'menu'</span> =&gt; <span class="hljs-keyword">array</span>(
    <span class="hljs-comment">// Одномерный пункт</span>
    <span class="hljs-keyword">array</span>(
        <span class="hljs-comment">// Заголовок пункта меню</span>
        <span class="hljs-string">'title'</span> =&gt; <span class="hljs-string">'Главная'</span>, 
        <span class="hljs-comment">// Постфикс font-awesome иконки</span>
        <span class="hljs-comment">// Если нужна fa-picture-o, то пишем picture-o)</span>
        <span class="hljs-string">'icon'</span>  =&gt; <span class="hljs-string">'home'</span>,  
        <span class="hljs-comment">// Ссылка на пункт меню (без префикса)</span>
        <span class="hljs-comment">// Пример: для http://site.com/admin/fcuk тут нужно записать только fcuk</span>
        <span class="hljs-string">'link'</span>  =&gt; <span class="hljs-string">'/'</span>,       
        <span class="hljs-comment">// Проверка прав на отображение пункта меню. </span>
        <span class="hljs-comment">// true|false — показывать|скрывать</span>
        <span class="hljs-string">'check'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;
        }
    ),
    <span class="hljs-comment">// Многомерный пункт</span>
    <span class="hljs-comment">// Элементы submenu могу содержать свои submenu</span>
    <span class="hljs-comment">// Лямбда функция check используется только для конечных пунктов</span>
    <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'title'</span> =&gt; <span class="hljs-string">'Упр. пользователями'</span>,
        <span class="hljs-string">'icon'</span>  =&gt; <span class="hljs-string">'user'</span>,
        <span class="hljs-string">'submenu'</span> =&gt; <span class="hljs-keyword">array</span>(
            <span class="hljs-keyword">array</span>(
                <span class="hljs-string">'title'</span>   =&gt; <span class="hljs-string">'Пользователи'</span>,
                <span class="hljs-string">'link'</span>    =&gt; <span class="hljs-string">'/tb/users'</span>,
                <span class="hljs-comment">// Паттерн для регулярки. Заменяет сравнивание текущего пути по 'link'</span>
                <span class="hljs-string">'pattern'</span> =&gt; <span class="hljs-string">'/tb/users/?\d*'</span>,
                <span class="hljs-string">'check'</span>   =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                    <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;
                }
            ),
            <span class="hljs-keyword">array</span>(
                <span class="hljs-string">'title'</span> =&gt; <span class="hljs-string">'Группы'</span>,
                <span class="hljs-string">'link'</span>  =&gt; <span class="hljs-string">'/tb/groups'</span>,
                <span class="hljs-string">'check'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                    <span class="hljs-variable">$readOnly</span> = Sentry::findGroupByName(<span class="hljs-string">'readonly'</span>);
                    <span class="hljs-keyword">return</span> !Sentry::getUser()-&gt;inGroup(<span class="hljs-variable">$readOnly</span>);
                }
            ),
        )
    ),
),
</code>
</pre>
                            
                        </div>
                    </div>
                </div>
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title"><a data-toggle="collapse" data-parent="#accordion-2" href="#collapseTwo-1" class="collapsed"> <i class="fa fa-fw fa-plus-circle txt-color-green"></i> <i class="fa fa-fw fa-minus-circle txt-color-red"></i> login.php </a></h4>
                    </div>
                    <div id="collapseTwo-1" class="panel-collapse collapse" style="height: 0px;">
                        <div class="panel-body">
                            <dl class="dl-horizontal">
                              <dt>is_active_remember_me</dt>
                              <dd>Отображение кнопки "запомнить меня".</dd>
                              <dt>background_url</dt>
                              <dd>Ссылка для фона страницы входа в админ-панель.</dd>
                              <dt>favicon_url</dt>
                              <dd>Ссылка на логотип сайта (отображение в правом верхнем углу формы входа).</dd>
                              <dt>top_block</dt>
                              <dd>HTML блока над формой входа.</dd>
                              <dt>bottom_block</dt>
                              <dd>HTML блока под формой входа.</dd>
                              <dt>on_login</dt>
                              <dd>Анонимка, которая вызывается после авторизации для входа в админ-панель.</dd>
                              <dt>on_logout</dt>
                              <dd>Анонимка, которая вызывается после выхода из админ-панели.</dd>
                            </dl>
                        </div>
                    </div>
                </div>
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title"><a data-toggle="collapse" data-parent="#accordion-2" href="#collapseThree-1" class="collapsed"> <i class="fa fa-fw fa-plus-circle txt-color-green"></i> <i class="fa fa-fw fa-minus-circle txt-color-red"></i> informer.php </a></h4>
                    </div>
                    <div id="collapseThree-1" class="panel-collapse collapse">
                        <div class="panel-body">
                            <dl class="dl-horizontal">
                              <dt>period</dt>
                              <dd>Частота обновления информера (задается в секундах).</dd>
                              <dt>tabs</dt>
                              <dd>Массив, по которому строится информер.</dd>
                            </dl>
                            
<pre><code class="php hljs">
<span class="hljs-string">'tabs'</span> =&gt; <span class="hljs-keyword">array</span>(
    <span class="hljs-comment">// Каждый пункт информера записывается массивом</span>
    <span class="hljs-comment">// Сколько массивов, столько и пунктов</span>
    <span class="hljs-keyword">array</span>(
        <span class="hljs-comment">// Заголовок пункта</span>
        <span class="hljs-string">'caption'</span> =&gt; <span class="hljs-string">'Новые комментарии'</span>,
        <span class="hljs-string">'info'</span> =&gt; <span class="hljs-keyword">array</span>(
             <span class="hljs-comment">// Лямбда для получения отображаемого количества</span>
             <span class="hljs-string">'count'</span>   =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                 <span class="hljs-keyword">return</span> rand(<span class="hljs-number">0</span>, <span class="hljs-number">12</span>);
             },
             <span class="hljs-comment">// Лямбда для получения контента по пункту информера</span>
             <span class="hljs-string">'content'</span>   =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                 <span class="hljs-keyword">return</span> <span class="hljs-string">'&lt;p style="padding: 20px;"&gt;Шутка, нету новых комментариев&lt;/p&gt;'</span>;
             },
        ),
        <span class="hljs-comment">// Лямбда для проверки прав на показ пункта информера. true|false</span>
        <span class="hljs-string">'check'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;
        }
    ),
    <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'caption'</span> =&gt; <span class="hljs-string">'Непросмотренные заказы'</span>,
        <span class="hljs-string">'info'</span> =&gt; <span class="hljs-keyword">array</span>(
             <span class="hljs-string">'count'</span>   =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                 <span class="hljs-keyword">return</span> DB::table(<span class="hljs-string">'orders'</span>)-&gt;where(<span class="hljs-string">'status'</span>, <span class="hljs-string">'pending'</span>)-&gt;count();
             },
             <span class="hljs-string">'content'</span>   =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                 <span class="hljs-variable">$orders</span> = Order::with(<span class="hljs-string">'user'</span>)-&gt;where(<span class="hljs-string">'status'</span>, <span class="hljs-string">'pending'</span>)-&gt;take(<span class="hljs-number">6</span>)-&gt;get();
                 
                 <span class="hljs-variable">$html</span> = <span class="hljs-string">''</span>;
                 <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$orders</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$order</span>) {
                     <span class="hljs-variable">$html</span> .= <span class="hljs-string">'&lt;p&gt;'</span>. <span class="hljs-variable">$order</span>-&gt;user-&gt;name .<span class="hljs-string">'-'</span>. <span class="hljs-variable">$order</span>-&gt;getSum() .<span class="hljs-string">'&lt;/p&gt;'</span>;
                 }
                 
                 <span class="hljs-keyword">return</span> <span class="hljs-variable">$html</span>;
             },
        ),
        <span class="hljs-string">'check'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;
        }
    ),
),
</code>
</pre>

                        </div>
                    </div>
                </div>
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title"><a data-toggle="collapse" data-parent="#accordion-2" href="#collapseFour-1" class="collapsed"> <i class="fa fa-fw fa-plus-circle txt-color-green"></i> <i class="fa fa-fw fa-minus-circle txt-color-red"></i> users.php </a></h4>
                    </div>
                    <div id="collapseFour-1" class="panel-collapse collapse">
                        <div class="panel-body">
                            <p class="alert alert-danger">Важно! Конфиг в ближайшем времени будет дополняться.</p>
                            <p class="alert alert-warning">Как использовать это разделение прав с группами и их наследованием? <a href="https://cartalyst.com/manual/sentry#permissions" target="_blank">Вот так</a>.</p>
                            <dl class="dl-horizontal">
                              <dt>permissions</dt>
                              <dd>Список отображаемых прав для их установления к пользователю или группе.</dd>
                              <dt>check</dt>
                              <dd>Массив с проверкой прав на действия с пользователями (желательно сразу поменять их на необходимые).</dd>
                            </dl>
                            
<pre><code class="php hljs">
<span class="hljs-string">'permissions'</span> =&gt; <span class="hljs-keyword">array</span>(
    <span class="hljs-comment">// Идентификатор группы прав</span>
    <span class="hljs-string">'user'</span> =&gt; <span class="hljs-keyword">array</span>(
        <span class="hljs-comment">// Заголовок группы</span>
        <span class="hljs-string">'caption'</span> =&gt; <span class="hljs-string">'Пользователи'</span>,
        <span class="hljs-comment">// И сами права с их заголовками</span>
        <span class="hljs-string">'rights'</span>  =&gt; <span class="hljs-keyword">array</span>(
            <span class="hljs-string">'view'</span>   =&gt; <span class="hljs-string">'Просмотр'</span>,
            <span class="hljs-string">'create'</span> =&gt; <span class="hljs-string">'Создание'</span>,
            <span class="hljs-string">'update'</span> =&gt; <span class="hljs-string">'Редактирование'</span>,
            <span class="hljs-string">'delete'</span> =&gt; <span class="hljs-string">'Удаление'</span>,
        ),
    ),
    <span class="hljs-comment">// Для примера. В проекте не использовать!</span>
    <span class="hljs-string">'grindgod'</span> =&gt; <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'caption'</span> =&gt; <span class="hljs-string">'Искры ананаса'</span>,
        <span class="hljs-string">'rights'</span>  =&gt; <span class="hljs-keyword">array</span>(
            <span class="hljs-string">'open'</span>     =&gt; <span class="hljs-string">'Открытие'</span>,
            <span class="hljs-string">'jump'</span>     =&gt; <span class="hljs-string">'Прыгать'</span>,
            <span class="hljs-string">'rumbling'</span> =&gt; <span class="hljs-string">'Урчание'</span>,
        ),
    ),
),
<span class="hljs-comment">// Если читали предыдущие пункты, то здесь вопросов не будет.</span>
<span class="hljs-string">'check'</span> =&gt; <span class="hljs-keyword">array</span>(
    <span class="hljs-string">'users'</span> =&gt; <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'create'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;
        },
        <span class="hljs-string">'update'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;
        },
        <span class="hljs-string">'delete'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;
        },
    ),
    <span class="hljs-string">'groups'</span> =&gt; <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'create'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;
        },
        <span class="hljs-string">'update'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;
        },
        <span class="hljs-string">'delete'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;
        },
    ),
),
</code>
</pre>
                            
                        </div>
                    </div>
                </div>
            </div>

        </div>
        <!-- end widget content -->

    </div>
    <!-- end widget div -->

</div>
</div>
<div class="well well-sm">
<h3 class="text-primary">Построение таблиц и смачные ништяки:</h3>
                    

<ul class="nav nav-tabs bordered">
    <li class="">
        <a href="#structure" data-toggle="tab">Структура</a>
    </li>
    <li class="active">
        <a href="#fields" data-toggle="tab">Поля</a>
    </li>
    <li>
        <a href="#callbacks" data-toggle="tab">Коллбеки</a>
    </li>
    <li>
        <a href="#traits" data-toggle="tab">Трейты</a>
    </li>
    <li>
        <a href="#helpers" data-toggle="tab">Хелперы</a>
    </li>
    <li class="pull-right">
        <a href="#common" data-toggle="tab">Quick Start</a>
    </li>
    <li class="pull-right">
        <a href="#mmmm" data-toggle="tab">Ништяки</a>
    </li>
</ul>

<div class="tab-content padding-10">
    <div class="tab-pane" id="structure">
        <div class="table-responsive">
            <p>Основные пункты для описания таблицы:</p>
<br>

<b>db</b> - описание настроек для формирования запросов к бд.
<pre><code class="php hljs">
<span class="hljs-string">'db'</span> =&gt; <span class="hljs-keyword">array</span>(
    <span class="hljs-string">'table'</span> =&gt; <span class="hljs-string">'products'</span>,
    <span class="hljs-string">'order'</span> =&gt; <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'id'</span> =&gt; <span class="hljs-string">'DESC'</span>,
    ),
    <span class="hljs-string">'pagination'</span> =&gt; <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'per_page'</span> =&gt; <span class="hljs-number">20</span>,
        <span class="hljs-string">'uri'</span> =&gt; <span class="hljs-string">'/admin/products'</span>,
    ),
),
</code>
</pre> 

<dl class="dl-horizontal">
  <dt>table</dt>
  <dd>Таблица из которой берутся/заносятся данные. <span class="label bg-color-red pull-right">обязательно</span></dd>
  <dt>order</dt>
  <dd>Первичная сортировка отображаемых данных. <span class="label bg-color-blueLight pull-right">без сортировки</span></dd>
  <dt>pagination.per_page</dt>
  <dd>Количество записей на страницу. <span class="label bg-color-red pull-right">обязательно</span></dd>
  <dt>pagination.uri</dt>
  <dd>Ссылка, которая отвечает за отображение таблицы (служит для построения правильной пагинации). <span class="label bg-color-red pull-right">обязательно</span></dd>
</dl>
<br>

<p>Также пагинацию можно указать в нескольких значениях, чтобы отобразить выбор на фронтенде.<br>
    В ключи массива записывается количество строк для пагинации, в значения - вывод их на фронтенде.
</p>
<pre><code class="php hljs">
<span class="hljs-string">'pagination'</span> =&gt; <span class="hljs-keyword">array</span>(
    <span class="hljs-comment">// ...</span>
    <span class="hljs-string">'per_page'</span> =&gt; <span class="hljs-keyword">array</span>(
        <span class="hljs-number">1</span> =&gt; <span class="hljs-string">'по одному'</span>, 
        <span class="hljs-number">20</span> =&gt; <span class="hljs-string">'20'</span>, 
        <span class="hljs-number">99999999</span> =&gt; <span class="hljs-string">'Я ХОЧУ ПОВЕСИТЬ БД'</span>
    ),
),
</code>
</pre> 
<hr>
<br>

<b>options</b> - описание настроек для формирования начального отображения форм и таблицы.
<pre><code class="php hljs">
<span class="hljs-string">'options'</span> =&gt; <span class="hljs-keyword">array</span>(
    <span class="hljs-string">'caption'</span>     =&gt; <span class="hljs-string">'Товары'</span>,
    <span class="hljs-string">'ident'</span>       =&gt; <span class="hljs-string">'products-container'</span>,
    <span class="hljs-string">'form_ident'</span>  =&gt; <span class="hljs-string">'products-form'</span>,
    <span class="hljs-string">'table_ident'</span> =&gt; <span class="hljs-string">'products-table'</span>,
    <span class="hljs-string">'action_url'</span>  =&gt; <span class="hljs-string">'/admin/handle/products'</span>,
    <span class="hljs-string">'not_found'</span>   =&gt; <span class="hljs-string">'NOT FOUND'</span>,
    <span class="hljs-string">'handler'</span>     =&gt; <span class="hljs-string">'ProductsTableHandler'</span>,
    <span class="hljs-string">'form_width'</span>  =&gt; <span class="hljs-string">'920px'</span>,
    <span class="hljs-comment">//'is_form_fullscreen' =&gt; true,</span>
    <span class="hljs-string">'is_sortable'</span> =&gt; <span class="hljs-keyword">true</span>,
),
</code>
</pre> 
<dl class="dl-horizontal">
  <dt>caption</dt>
  <dd>Заголовок таблицы. <span class="label bg-color-red pull-right">обязательно</span></dd>
  <dt>ident</dt>
  <dd>Идентификатор контейнера формы и таблицы (можно любой вписать). <span class="label bg-color-red pull-right">обязательно</span></dd>
  <dt>form_ident</dt>
  <dd>Идентификатор формы (можно любой вписать). <span class="label bg-color-red pull-right">обязательно</span></dd>
  <dt>table_ident</dt>
  <dd>Идентификатор таблицы (можно любой вписать). <span class="label bg-color-red pull-right">обязательно</span></dd>
  <dt>action_url</dt>
  <dd>Ссылка, которая отвечает за обработку таблицы (для запросов методом <code>POST</code>). <span class="label bg-color-red pull-right">обязательно</span></dd>
  <dt>not_found</dt>
  <dd>Текст, который показывается, если таблица пустая. <span class="label bg-color-blueLight pull-right">No data found</span></dd>
  <dt>handler</dt>
  <dd>Имя класса хендлера для текущего описания таблицы. <span class="label bg-color-blueLight pull-right">коллбеки хендлера не влияют</span></dd>
  <dt>form_width</dt>
  <dd>Ширина для формы редактирования и создания. <span class="label bg-color-blueLight pull-right">какая-то дефолтная</span></dd>
  <dt>is_form_fullscreen</dt>
  <dd>Флаг для развертывания формы во весь экран. <span class="label bg-color-blueLight pull-right">false</span></dd>
  <dt>is_sortable</dt>
  <dd>Флаг для отображения сортировки таблицы. Для коректной сортировки необходимо вывести все поля таблицы отсортированные по <code>priority</code>. Необходимо наличие поля <code>priority</code>. <span class="label bg-color-blueLight pull-right">false</span></dd>
</dl>

<hr>
<br>


<b>fields</b> - перечень полей для таблицы и формы. Ключ содержит названия поля в бд, а в значении описываются его настройки для отображения.
<pre><code class="php hljs">
<span class="hljs-string">'fields'</span> =&gt; <span class="hljs-keyword">array</span>(
    <span class="hljs-string">'id'</span> =&gt; <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'caption'</span> =&gt; <span class="hljs-string">'#'</span>,
        <span class="hljs-comment">// ...</span>
    ),
    <span class="hljs-comment">// ...</span>
),
</code>
</pre> 

<hr>
<br>


<b>filters</b> - перечень условий для формирования каждой выборки данных из таблицы. В ключ записывается название поля таблицы, а в значение его способ выборки.

<p class="alert alert-danger">Важно! Значения фильтра записываются автоматически при создании нового поля.</p>

<pre><code class="php hljs">
<span class="hljs-string">'filters'</span> =&gt; <span class="hljs-keyword">array</span>(
    <span class="hljs-string">'type'</span> =&gt; <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'sign'</span>  =&gt; <span class="hljs-string">'='</span>,
        <span class="hljs-string">'value'</span> =&gt; <span class="hljs-string">'main'</span>
    ),
    <span class="hljs-string">'status'</span> =&gt; <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'sign'</span>  =&gt; <span class="hljs-string">'='</span>,
        <span class="hljs-string">'value'</span> =&gt; <span class="hljs-string">'active'</span>
    )
),
</code>
</pre> 

<p>Также может быть анонимкой (в таком случае значения автоматически не записываются при создании новой записи):</p>
<pre><code class="php hljs">
<span class="hljs-string">'filters'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(&amp;<span class="hljs-variable">$db</span>)</span> <span class="hljs-title">use</span><span class="hljs-params">(<span class="hljs-variable">$options</span>)</span> </span>{
    <span class="hljs-variable">$db</span>-&gt;whereIn(<span class="hljs-string">'products.id'</span>, <span class="hljs-variable">$options</span>[<span class="hljs-string">'ids'</span>]);
},
</code>
</pre> 

<dl class="dl-horizontal">
  <dt>filters[]sign</dt>
  <dd>Признак сравнения. <span class="label bg-color-red pull-right">обязательно</span></dd>
  <dt>filters[]value</dt>
  <dd>Значение поля. <span class="label bg-color-red pull-right">обязательно</span></dd>
</dl>

<hr>
<br>

<b>actions</b> - перечень действий для таблицы.
<pre><code class="php hljs">
<span class="hljs-string">'actions'</span> =&gt; <span class="hljs-keyword">array</span>(
    <span class="hljs-string">'search'</span> =&gt; <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'caption'</span> =&gt; <span class="hljs-string">'Поиск'</span>,
    ),
    <span class="hljs-string">'insert'</span> =&gt; <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'caption'</span> =&gt; <span class="hljs-string">'Добавить'</span>,
        <span class="hljs-string">'mode'</span> =&gt; <span class="hljs-string">'new'</span>,
        <span class="hljs-string">'check'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;
        }
    ),
    <span class="hljs-string">'update'</span> =&gt; <span class="hljs-keyword">array</span>(),
    <span class="hljs-string">'delete'</span> =&gt; <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'check'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;
        }
    ),
),
</code>
</pre> 
<dl class="dl-horizontal">
  <dt>actions[]caption</dt>
  <dd>Заголовок для кнопки действия. <span class="label bg-color-blueLight pull-right">дефолтный</span></dd>
  <dt>actions[]mode</dt>
  <dd>Тип открытия формы (<code>new</code> - в всей странице). <span class="label bg-color-blueLight pull-right">в модалке</span></dd>
  <dt>filters[]check</dt>
  <dd>Лямбда для проверки прав на исполнение и показ действия. <span class="label bg-color-blueLight pull-right">true</span></dd>
</dl>

<hr>
<br>
<p>Вспомогательные пункты для описания таблицы:</p>
<br>

<b>export</b> - описание правил для экспорта данных по таблице.
<pre><code class="php hljs">
<span class="hljs-string">'export'</span> =&gt; <span class="hljs-keyword">array</span>(
    <span class="hljs-string">'caption'</span>  =&gt; <span class="hljs-string">'Экспорт'</span>,
    <span class="hljs-string">'filename'</span> =&gt; <span class="hljs-string">'exp'</span>,
    <span class="hljs-string">'width'</span>    =&gt; <span class="hljs-string">'300'</span>,
    <span class="hljs-string">'date_range_field'</span> =&gt; <span class="hljs-string">'datetime'</span>,
    <span class="hljs-string">'buttons'</span> =&gt; <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'xls'</span> =&gt; <span class="hljs-keyword">array</span>(
            <span class="hljs-string">'caption'</span> =&gt; <span class="hljs-string">'в XLS'</span>,
        ),
        <span class="hljs-string">'csv'</span> =&gt; <span class="hljs-keyword">array</span>(
            <span class="hljs-string">'caption'</span> =&gt; <span class="hljs-string">'в CSV'</span>,
            <span class="hljs-string">'delimiter'</span> =&gt; <span class="hljs-string">';'</span>
        ),
    ),
    <span class="hljs-string">'handle'</span> =&gt; <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'list'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(&amp;<span class="hljs-variable">$fields</span>)</span> </span>{
            <span class="hljs-variable">$fields</span>[<span class="hljs-string">'url'</span>] = <span class="hljs-string">'URL'</span>;
        },
        <span class="hljs-string">'export'</span> =&gt; <span class="hljs-keyword">array</span> (
            <span class="hljs-string">'caption'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(&amp;<span class="hljs-variable">$idents</span>)</span> </span>{
                <span class="hljs-variable">$newFields</span> = <span class="hljs-keyword">array</span>();
                <span class="hljs-variable">$newFields</span>[<span class="hljs-string">'url'</span>] = <span class="hljs-string">'URL'</span>;
                <span class="hljs-keyword">return</span> <span class="hljs-variable">$newFields</span>;
            },
            <span class="hljs-string">'rows'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(<span class="hljs-variable">$id</span>, <span class="hljs-variable">$row</span>, <span class="hljs-variable">$ident</span>, &amp;<span class="hljs-variable">$value</span>)</span> </span>{
                <span class="hljs-keyword">if</span> (<span class="hljs-variable">$ident</span> == <span class="hljs-string">'url'</span>) {
                    <span class="hljs-variable">$value</span> = URL::to(<span class="hljs-string">'/product/'</span>. TableBuilder::urlify(<span class="hljs-variable">$row</span>[<span class="hljs-string">'name'</span>]) .<span class="hljs-string">'-'</span>. <span class="hljs-variable">$id</span>);
                }
            },
            <span class="hljs-string">'filter'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(<span class="hljs-variable">$rows</span>)</span> <span class="hljs-title">use</span><span class="hljs-params">(<span class="hljs-variable">$options</span>)</span> </span>{
                <span class="hljs-variable">$new</span> = <span class="hljs-keyword">array</span>();
                <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$rows</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$row</span>) {
                    <span class="hljs-keyword">if</span> (in_array(<span class="hljs-variable">$row</span>[<span class="hljs-string">'id'</span>], <span class="hljs-variable">$options</span>[<span class="hljs-string">'ids'</span>])) {
                        <span class="hljs-variable">$new</span>[] = <span class="hljs-variable">$row</span>;
                    }
                }
                <span class="hljs-keyword">return</span> <span class="hljs-variable">$new</span>;
            }, <span class="hljs-comment">// end filter</span>
        ),
    ),
    <span class="hljs-string">'check'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;
    }
),
</code>
</pre> 
<dl class="dl-horizontal">
  <dt>caption</dt>
  <dd>Заголовок для кнопки экспорта. <span class="label bg-color-blueLight pull-right">Export</span></dd>
  <dt>filename</dt>
  <dd>Префикс к экспортируемому файлу. <span class="label bg-color-blueLight pull-right">export</span></dd>
  <dt>width</dt>
  <dd>Ширина дропдауна для экспорта. <span class="label bg-color-blueLight pull-right">260</span></dd>
  <dt>date_range_field</dt>
  <dd>Название поля по которому будет происходить выборка по дате. <span class="label bg-color-blueLight pull-right">без выборки</span></dd>
  <dt>buttons</dt>
  <dd>Массив для возможных вариантов экспорта. <span class="label bg-color-red pull-right">Можно отавить пустым, но толку-то?</span></dd>
  <dt>buttons[]</dt>
  <dd>Тип экспорта (<code>xls|csv</code>). <span class="label bg-color-red pull-right">обязательно</span></dd>
  <dt>buttons[]caption</dt>
  <dd>Заголовок кнопки экспорта в формате. <span class="label bg-color-red pull-right">обязательно</span></dd>
  <dt>buttons[]delimiter</dt>
  <dd>Разделитель колонок (только для <code>csv</code>). <span class="label bg-color-blueLight pull-right">запятая (,)</span></dd>
  <dt>check</dt>
  <dd>Лямбда для проверки прав на экспорт. <span class="label bg-color-blueLight pull-right">запятая (,)</span></dd>
</dl>

<hr>

<b>import</b> - описание правил для импорта (обноления) данных по таблице.
<pre><code class="php hljs">
<span class="hljs-string">'import'</span> =&gt; <span class="hljs-keyword">array</span>(
    <span class="hljs-string">'caption'</span>  =&gt; <span class="hljs-string">'Импорт'</span>,
    <span class="hljs-string">'filename'</span> =&gt; <span class="hljs-string">'imp_tem'</span>,
    <span class="hljs-string">'width'</span>    =&gt; <span class="hljs-string">'300'</span>,
    <span class="hljs-string">'pk'</span> =&gt; <span class="hljs-string">'id'</span>,
    <span class="hljs-string">'fields'</span> =&gt; <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'id'</span>    =&gt; <span class="hljs-string">'Идентификатор'</span>,
        <span class="hljs-string">'name'</span>  =&gt; <span class="hljs-string">'Название'</span>,
        <span class="hljs-string">'price'</span> =&gt; <span class="hljs-string">'Цена'</span>
    ),
    <span class="hljs-string">'files'</span> =&gt; <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'csv'</span> =&gt; <span class="hljs-keyword">array</span>(
            <span class="hljs-string">'caption'</span>   =&gt; <span class="hljs-string">'файл в CSV'</span>,
            <span class="hljs-string">'delimiter'</span> =&gt; <span class="hljs-string">';'</span>
        ),
    ),
    <span class="hljs-string">'check'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;
    }
),
</code>
</pre> 
<dl class="dl-horizontal">
  <dt>caption</dt>
  <dd>Заголовок для кнопки импорта. <span class="label bg-color-blueLight pull-right">Import</span></dd>
  <dt>filename</dt>
  <dd>Префикс к экспортируемому примеру импортируемого файла. <span class="label bg-color-blueLight pull-right">import_template</span></dd>
  <dt>width</dt>
  <dd>Ширина дропдауна для импорта. <span class="label bg-color-blueLight pull-right">260</span></dd>
  <dt>pk</dt>
  <dd>Ключ по которому будет производится обновление. <span class="label bg-color-blueLight pull-right">елси пустое, то возьмется первый ключ из fields</span></dd>
  <dt>fields</dt>
  <dd>Поля для импорта (ключ - название поля, значение - его заголовок). <span class="label bg-color-red pull-right">обязательно</span></dd>
  <dt>files</dt>
  <dd>Перечень типов импорта (пока доступен только <code>csv</code>). <span class="label bg-color-red pull-right">Можно отавить пустым, но толку-то?</span></dd>
  <dt>files[]caption</dt>
  <dd>Заголовок кнопки импорта в формате. <span class="label bg-color-red pull-right">обязательно</span></dd>
  <dt>files[]delimiter</dt>
  <dd>Разделитель колонок (только для <code>csv</code>). <span class="label bg-color-blueLight pull-right">запятая (,)</span></dd>
  <dt>check</dt>
  <dd>Лямбда для проверки прав на импорт. <span class="label bg-color-blueLight pull-right">запятая (,)</span></dd>
</dl>
<hr>


<b>multi_actions</b> - групповой выбор полей для действий. Представляет из себя массив ключей (идентификаторов, которые сам придумаешь) и их значений-описаний.
<pre><code class="php hljs">
<span class="hljs-string">'multi_actions'</span> =&gt; <span class="hljs-keyword">array</span>(
    <span class="hljs-string">'oh'</span> =&gt; <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'caption'</span> =&gt; <span class="hljs-string">'Remove'</span>,
        <span class="hljs-string">'check'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;
        },
        <span class="hljs-string">'handle'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(<span class="hljs-variable">$ids</span>)</span> </span>{
            <span class="hljs-variable">$errors</span> = array_map(
                <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(<span class="hljs-variable">$id</span>)</span> </span>{
                     <span class="hljs-keyword">return</span> <span class="hljs-string">'Поле не редактируемо: #'</span>. <span class="hljs-variable">$id</span>; 
                }, 
                <span class="hljs-variable">$ids</span>
            );
            
            <span class="hljs-variable">$data</span> = <span class="hljs-keyword">array</span>(
                <span class="hljs-comment">// true|false. в случае успеха/ошибки</span>
                <span class="hljs-string">'status'</span> =&gt; <span class="hljs-keyword">false</span>,
                <span class="hljs-comment">// массив(!) ошибок для отображения на фронтенде</span>
                <span class="hljs-string">'errors'</span> =&gt; <span class="hljs-variable">$errors</span>
            );
            <span class="hljs-keyword">return</span> <span class="hljs-variable">$data</span>;
        },
    ),
    <span class="hljs-string">'hai'</span> =&gt; <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'caption'</span> =&gt; <span class="hljs-string">'Щито'</span>,
        <span class="hljs-string">'class'</span>   =&gt; <span class="hljs-string">'bg-color-blueLight txt-color-white'</span>,
        <span class="hljs-string">'is_hide_rows'</span> =&gt; <span class="hljs-keyword">true</span>,
        <span class="hljs-string">'check'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;
        },
        <span class="hljs-string">'handle'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(<span class="hljs-variable">$ids</span>)</span> </span>{
            <span class="hljs-variable">$data</span> = <span class="hljs-keyword">array</span>(
                <span class="hljs-string">'status'</span>  =&gt; <span class="hljs-keyword">true</span>,
                <span class="hljs-comment">// строка(!) для оповещения об успешности действия</span>
                <span class="hljs-string">'message'</span> =&gt; <span class="hljs-string">'Запрос успешно выполнен'</span>
            );
            <span class="hljs-keyword">return</span> <span class="hljs-variable">$data</span>;
        },
    ),
    <span class="hljs-string">'move'</span> =&gt; <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'caption'</span> =&gt; <span class="hljs-string">'Move to gallery'</span>,
        <span class="hljs-string">'check'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;
        },
        <span class="hljs-string">'options'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-variable">$galleries</span> = DB::table(<span class="hljs-string">'galleries'</span>)-&gt;select(<span class="hljs-string">'id'</span>, <span class="hljs-string">'name'</span>)-&gt;get();
            <span class="hljs-variable">$data</span> = <span class="hljs-keyword">array</span>();
            <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$galleries</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$gallery</span>) {
                <span class="hljs-variable">$data</span>[<span class="hljs-variable">$gallery</span>[<span class="hljs-string">'id'</span>]] = <span class="hljs-variable">$gallery</span>[<span class="hljs-string">'name'</span>];
            }
            
            <span class="hljs-keyword">return</span> <span class="hljs-variable">$data</span>;
        },
        <span class="hljs-string">'handle'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(<span class="hljs-variable">$ids</span>, <span class="hljs-variable">$idOption</span>)</span> </span>{
            DB::table(<span class="hljs-string">'images'</span>)-&gt;whereIn(<span class="hljs-string">'id'</span>, <span class="hljs-variable">$ids</span>)-&gt;update(<span class="hljs-keyword">array</span>(
                <span class="hljs-string">'id_gallery'</span> =&gt; <span class="hljs-variable">$idOption</span>,
            ));
            
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">array</span>(
                <span class="hljs-string">'status'</span>  =&gt; <span class="hljs-keyword">true</span>,
                <span class="hljs-string">'message'</span> =&gt; <span class="hljs-string">'Successfully moved'</span>
            );
        },
    ),
     
),
</code>
</pre> 

<dl class="dl-horizontal">
  <dt>multi_actions[]caption</dt>
  <dd>Заголовок для кнопки действия. <span class="label bg-color-red pull-right">обязательно</span></dd>
  <dt>multi_actions[]class</dt>
  <dd>Дополнительные классы к кнопке действия. <span class="label bg-color-blueLight pull-right">ничего</span></dd>
  <dt>multi_actions[]is_hide_rows</dt>
  <dd>Флаг для скрытия полей, по которым шла обработка. Скрываются после ответа об успехе. <span class="label bg-color-blueLight pull-right">false</span></dd>
  <dt>multi_actions[]check</dt>
  <dd>Замыкание для проверки прав на групповое действие. <span class="label bg-color-red pull-right">обязательно</span></dd>
  <dt>multi_actions[]options</dt>
  <dd>Для выборки вариантов к экшну. В ключе значение, которое поопадет в <code>handle::$idOption</code>, в значении - название на фронтенд. <span class="label bg-color-blueLight pull-right">обычный экшн</span></dd>
  <dt>multi_actions[]handle</dt>
  <dd>Замыкание для обработки по действию. <code>$ids</code> содержит <code>id</code> выбранных полей. <code>$idOption</code> присутствует толкьо если есть опции экшна. <span class="label bg-color-red pull-right">обязательно</span></dd>
</dl>



<hr>


<b>position</b> - разбиение полей по табам.
<pre><code class="php hljs">
<span class="hljs-string">'position'</span> =&gt; <span class="hljs-keyword">array</span>(
    <span class="hljs-string">'tabs'</span> =&gt; <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'таб 1'</span> =&gt; <span class="hljs-keyword">array</span>(<span class="hljs-string">'title'</span>, <span class="hljs-string">'datetime'</span>),
        <span class="hljs-string">'таб 2'</span> =&gt; <span class="hljs-keyword">array</span>(<span class="hljs-string">'image'</span>, <span class="hljs-string">'description'</span>),
    )
),
</code>
</pre> 

<dl class="dl-horizontal">
  <dt>tabs</dt>
  <dd>Массив опций таба. <span class="label bg-color-red pull-right">обязательно</span>
     <br> В ключе название таба, в значении - перечень идентификаторов полей, которые в нем должны отображаться.</dd>
</dl>



<hr>


<b>callbacks</b> - коллбеки для дефинишна. Все то же самое, что и в хендлере.
<pre><code class="php hljs">
<span class="hljs-string">'callbacks'</span> =&gt; <span class="hljs-keyword">array</span>(
    <span class="hljs-string">'onUpdateRowResponse'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(array &amp;<span class="hljs-variable">$response</span>)</span> </span>{
        <span class="hljs-variable">$def</span> = <span class="hljs-variable">$this</span>-&gt;controller-&gt;getDefinition();
        <span class="hljs-comment">// ...</span>
    },
    <span class="hljs-string">'onDeleteRowResponse'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(array &amp;<span class="hljs-variable">$response</span>)</span> </span>{
        <span class="hljs-comment">// ...</span>
    },
),
</code>
</pre> 




        </div>
    </div>
    <div class="tab-pane active" id="fields">
        <div class="table-responsive">
            <style>
    div.tab-content.min-500 {
        min-height: 525px;
    }
    div.tabs-left>.tab-content {
        margin-left: 139px;
    }
    div.tab-pane.active>p {
        padding-top: 11px;
    }
    ul.nav.p-abs {
        position: absolute;
    }
</style>

<div class="tabs-left">
    <ul class="nav nav-tabs tabs-left p-abs">
        <li class="">
            <a href="#f-text" data-toggle="tab"> Общее и text </a>
        </li>
        <li>
            <a href="#f-readonly" data-toggle="tab"> readonly </a>
        </li>
        <li>
            <a href="#f-textarea" data-toggle="tab"> textarea </a>
        </li>
        <li>
            <a href="#f-select" data-toggle="tab"> select </a>
        </li>
        <li>
            <a href="#f-checkbox" data-toggle="tab"> checkbox </a>
        </li>
        <li>
            <a href="#f-wysiwyg" data-toggle="tab"> wysiwyg </a>
        </li>
        <li>
            <a href="#f-datetime" data-toggle="tab"> datetime </a>
        </li>
        <li>
            <a href="#f-timestamp" data-toggle="tab"> timestamp </a>
        </li>
        <li>
            <a href="#f-image" data-toggle="tab"> image </a>
        </li>
        <li>
            <a href="#f-file" data-toggle="tab"> file </a>
        </li>
        <li>
            <a href="#f-foreign" data-toggle="tab"> foreign key </a>
        </li>
        <li class="active">
            <a href="#f-many2many" data-toggle="tab"> many2many </a>
        </li>
        <li>
            <a href="#f-color" data-toggle="tab"> color </a>
        </li>
        <li>
            <a href="#f-custom" data-toggle="tab"> custom </a>
        </li>
        <li>
            <a href="#f-pattern" data-toggle="tab"> паттерн </a>
        </li>
    </ul>
    <div class="tab-content min-500">
        
        <div class="tab-pane" id="f-text">
            <p>
    Пример поля с типом <code>text</code>:
</p>
<pre><code class="php hljs">
<span class="hljs-string">'title'</span> =&gt; <span class="hljs-keyword">array</span>(
    <span class="hljs-string">'caption'</span>     =&gt; <span class="hljs-string">'Title'</span>,
    <span class="hljs-string">'type'</span>        =&gt; <span class="hljs-string">'text'</span>,
    <span class="hljs-string">'filter'</span>      =&gt; <span class="hljs-string">'text'</span>,
    <span class="hljs-string">'class'</span>       =&gt; <span class="hljs-string">'col-id'</span>,
    <span class="hljs-string">'width'</span>       =&gt; <span class="hljs-string">'1%'</span>,
    <span class="hljs-string">'hide'</span>        =&gt; <span class="hljs-keyword">true</span>,
    <span class="hljs-string">'hide_list'</span>   =&gt; <span class="hljs-keyword">true</span>,
    <span class="hljs-string">'mask'</span>        =&gt; <span class="hljs-string">'aa - a'</span>
    <span class="hljs-string">'is_sorting'</span>  =&gt; <span class="hljs-keyword">true</span>,
    <span class="hljs-string">'placeholder'</span> =&gt; <span class="hljs-string">'Just a placeholder'</span>,
),
</code>
</pre>
<br>
            <dl class="dl-horizontal">
              <dt>caption</dt>
              <dd>Отображаемый заголовок для поля. <span class="label bg-color-blueLight pull-right">идентификатор самого поля</span></dd>
              <dt>type</dt>
              <dd>Его тип, по которому оно формируется и валидируется. <span class="label bg-color-red pull-right">обязательное</span></dd>
              <dt>filter</dt>
              <dd>Тип поля для фильтрации. <span class="label bg-color-blueLight pull-right">не отображается поле фильтрации</span></dd>
              <dt>class</dt>
              <dd>Добавляемый класс к колонке этого поля. <span class="label bg-color-blueLight pull-right">без доп.класса</span></dd>
              <dt>width</dt>
              <dd>Ширина колонки этого поля. <span class="label bg-color-blueLight pull-right">без ширины</span></dd>
              <dt>hide</dt>
              <dd>Флаг для скрытия отображения в форме создания и обновления. <span class="label bg-color-blueLight pull-right">отображается в форме</span></dd>
              <dt>hide_list</dt>
              <dd>Флаг для скрытия отображения поля в списке. <span class="label bg-color-blueLight pull-right">отображается в списке</span></dd>
              <dt>mask</dt>
              <dd>Маска для поля (пока что используется <a target="_blank" href="http://digitalbush.com/projects/masked-input-plugin/">этот плагин</a>). <span class="label bg-color-blueLight pull-right">без маски</span></dd>
              <dd>Лучше пока воздержаться от использования маски, т.к. в ближайшем времени она видоизменится.</dd>
              <dt>is_sorting</dt>
              <dd>Сортировка ASC/DESC по нажатию на заголовок поля. <span class="label bg-color-blueLight pull-right">без сортировки</span></dd>
              <dt>placeholder</dt>
              <dd>Плейсхолдер для поля. <span class="label bg-color-blueLight pull-right">без плейсхолдера</span></dd>
            </dl>
            
            <hr>
            
            <p>
                Также можно и желательно использовать валидацию для поля.<br>
                Как обычно, она делится на две части: фронтенд и бэкенд.
            </p>
<pre><code class="php hljs">
<span class="hljs-string">'email'</span> =&gt; <span class="hljs-keyword">array</span>(
    <span class="hljs-comment">// ...</span>
    <span class="hljs-string">'validation'</span> =&gt; <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'server'</span> =&gt; <span class="hljs-keyword">array</span>(
            <span class="hljs-string">'rules'</span> =&gt; <span class="hljs-string">'required|email'</span>,
            <span class="hljs-string">'messages'</span> =&gt; <span class="hljs-keyword">array</span>(
                <span class="hljs-string">'required'</span> =&gt; <span class="hljs-string">'Обязательно к заполнению'</span>,
                <span class="hljs-string">'email'</span>    =&gt; <span class="hljs-string">'Не валидный имейл'</span>,
            )  
        ),
        <span class="hljs-string">'client'</span> =&gt; <span class="hljs-keyword">array</span>(
            <span class="hljs-string">'rules'</span> =&gt; <span class="hljs-keyword">array</span>(
                <span class="hljs-string">'required'</span> =&gt; <span class="hljs-keyword">true</span>
            ),
            <span class="hljs-string">'messages'</span> =&gt; <span class="hljs-keyword">array</span>(
                <span class="hljs-string">'required'</span> =&gt; <span class="hljs-string">'Обязательно к заполнению'</span>
            )   
        )
    ),
),
</code>
</pre>
            <dl class="dl-horizontal">
              <dt>server.rules</dt>
              <dd>Обычный перечень правил для валидации класса <code>Validation</code> (<a href="http://laravel.com/docs/4.2/validation#available-validation-rules" target="_blank">перечень тут</a>)</dd>
              <dt>server.messages</dt>
              <dd>Перечень кастомных сообщений по серверной валидации.</dd>
              <dt>client.rules</dt>
              <dd>В отличии от серверной части, записываются в массив. (о возможных правилах можно <a href="http://jqueryvalidation.org/documentation/" target="_blank">почитать тут</a>)</dd>
              <dt>client.messages</dt>
              <dd>Перечень кастомных сообщений по клиентской валидации.</dd>
            </dl>

            <hr>

            <p>Плюс ко всему можно использовать табы для поля (табы доступны не для всех типов полей).<br>
            Обычно табы используются для записи разных языковых версий поля.</p>

<pre><code class="php hljs">
<span class="hljs-string">'name'</span> =&gt; <span class="hljs-keyword">array</span>(
    <span class="hljs-comment">// ...</span>
    <span class="hljs-string">'tabs'</span> =&gt; <span class="hljs-keyword">array</span>(
        <span class="hljs-keyword">array</span>(
            <span class="hljs-string">'caption'</span>     =&gt; <span class="hljs-string">'ru'</span>,
            <span class="hljs-string">'postfix'</span>     =&gt; <span class="hljs-string">''</span>,
            <span class="hljs-string">'placeholder'</span> =&gt; <span class="hljs-string">'Название на русском'</span>
        ),
        <span class="hljs-keyword">array</span>(
            <span class="hljs-string">'caption'</span>     =&gt; <span class="hljs-string">'ua'</span>,
            <span class="hljs-string">'postfix'</span>     =&gt; <span class="hljs-string">'_ua'</span>,
            <span class="hljs-string">'placeholder'</span> =&gt; <span class="hljs-string">'Название на украинском'</span>
        ),
    ),
),
</code>
</pre>

            <dl class="dl-horizontal">
              <dt>tabs</dt>
              <dd>Массив табов (сколько вписать, столько и отобразится).</dd>
              <dt>tabs[]caption</dt>
              <dd>Заголовок таба.</dd>
              <dt>tabs[]postfix</dt>
              <dd>Постфикс поля (в примере запись будет идти на два поля: name и name_ua).</dd>
              <dt>tabs[]placeholder</dt>
              <dd>Плейсхолдер для поля в табе (ес-но, отобразится только для поля с типом <code>text</code>).</dd>
            </dl>

            <p class="alert alert-info">Как норм доставать эти переводы? Смотреть вкладку трейтов.</p>            
        </div>
        
        <div class="tab-pane" id="f-readonly">
            <p>Тот же самый <code>text</code>, но без возможности редактирования.</p>        </div>        
        
        <div class="tab-pane" id="f-textarea">
            <p>
        Обычная <code>&lt;textarea&gt;&lt;/textarea&gt;</code>.<br>
        Дополнительные опции:
    </p>
    
<pre><code class="php hljs">
<span class="hljs-string">'address'</span> =&gt; <span class="hljs-keyword">array</span>(
    <span class="hljs-comment">// ...</span>
    <span class="hljs-string">'rows'</span> =&gt; <span class="hljs-number">2</span>,
),
</code>
</pre>            
    
    <dl class="dl-horizontal">
      <dt>rows</dt>
      <dd>Количество строк для инпута. <span class="label bg-color-blueLight pull-right">3</span></dd>
    </dl>        </div>
        
        <div class="tab-pane" id="f-select">
            <p>
    Обычная <code>&lt;select&gt;&lt;/select&gt;</code>.<br>
    Дополнительные опции:
</p>

<pre><code class="php hljs">
<span class="hljs-string">'status'</span> =&gt; <span class="hljs-keyword">array</span>(
    <span class="hljs-comment">// ...</span>
    <span class="hljs-string">'options'</span> =&gt; <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'pending'</span> =&gt; <span class="hljs-string">'В ожидании'</span>,
        <span class="hljs-string">'active'</span>  =&gt; <span class="hljs-string">'Активен'</span>,
    ),
    <span class="hljs-comment">// ...</span>
    <span class="hljs-string">'colors'</span> =&gt; <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'pending'</span> =&gt; <span class="hljs-string">'lightpink'</span>,
        <span class="hljs-string">'active'</span>  =&gt; <span class="hljs-string">'lightcyan'</span>,
    ),
    <span class="hljs-string">'is_tr_color'</span> =&gt; <span class="hljs-keyword">true</span>,
),
</code>
</pre>            

<dl class="dl-horizontal">
  <dt>options</dt>
  <dd>Опции для селекта. <span class="label bg-color-red pull-right">обязательное</span> <br>
       Ключем выступает значение, что пойдет в бд, значение элемента — его отображаемый заголовок.
  </dd>
  
  <dt>colors</dt>
  <dd>Цвета для <code>td</code> опции селекта. <span class="label bg-color-blueLight pull-right">ниет</span> <br>
       Ключем выступает идент опции, значение - цвет.
  </dd>
  
  <dt>is_tr_color</dt>
  <dd>Флаг для закрашивания не <code>td</code>, a <code>tr</code>. <span class="label bg-color-blueLight pull-right">false</span> <br>
       Закрашивание <code>td</code> приоритетнее, чем закрашивание <code>tr</code>.
  </dd>
</dl>        </div>
        
        <div class="tab-pane" id="f-checkbox">
            <p>
    Да-да, это чекбокс.<br>
    Дополнительные опции:
</p>

<pre><code class="php hljs">
<span class="hljs-string">'is_active'</span> =&gt; <span class="hljs-keyword">array</span>(
    <span class="hljs-comment">// ...</span>
    <span class="hljs-string">'is_null'</span> =&gt; <span class="hljs-keyword">true</span>,
),
</code>
</pre>            

<dl class="dl-horizontal">
  <dt>is_null</dt>
  <dd>Флаг для обозначения, что не выбранный чекбокс должен записаться в бд как <code>NULL</code>, иначе запишется <code>0</code>.  <span class="label bg-color-blueLight pull-right">false</span>
  </dd>
</dl>        </div>
        
        <div class="tab-pane" id="f-wysiwyg">
            <p>
    WYSIWYG-редактор. <br>
    Сейчас используется кастомный <a href="http://summernote.org/" target="_blank">Summernote</a>, со временем добавятся и другие, если будет необходимо.<br>
    Дополнительные опции:<br>
    
    </p><pre>    <code class="php hljs">
    <span class="hljs-string">'description'</span> =&gt; <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'caption'</span> =&gt; <span class="hljs-string">'Desc'</span>,
        <span class="hljs-string">'type'</span>    =&gt; <span class="hljs-string">'wysiwyg'</span>,
        <span class="hljs-string">'wysiwyg'</span> =&gt; <span class="hljs-string">'redactor'</span>,
        <span class="hljs-string">'editor-options'</span> =&gt; <span class="hljs-keyword">array</span>(
            <span class="hljs-string">'lang'</span> =&gt; <span class="hljs-string">'ru-RU'</span>,
        ),
    )
    </code>
    </pre>   
    <dl class="dl-horizontal">
      <dt>wysiwyg</dt>
      <dd>Тип висивига (<code>summernote|redactor</code>). <span class="label bg-color-blueLight pull-right">summernote</span></dd>
      <dt>editor-options</dt>
      <dd>Перечень настроек редактора для инициализации (<code>summernote</code>). <span class="label bg-color-blueLight pull-right">без них</span></dd>
    </dl>
<p></p>        </div>
        
        <div class="tab-pane" id="f-datetime">
            <p>
    Поле типа <code>datetime</code>.<br>
    Дополнительные опции:
</p>

<pre><code class="php hljs">
<span class="hljs-string">'show_date'</span> =&gt; <span class="hljs-keyword">array</span>(
    <span class="hljs-comment">// ...</span>
    <span class="hljs-string">'months'</span>   =&gt; <span class="hljs-number">2</span>,
    <span class="hljs-string">'is_range'</span> =&gt; <span class="hljs-keyword">true</span>
),
</code>
</pre>            

<dl class="dl-horizontal">
  <dt>months</dt>
  <dd>Количетво отображаемых месяцев в форме редактирования и создания.  <span class="label bg-color-blueLight pull-right">1</span></dd>
  <dt>is_range</dt>
  <dd>Признак фильтрации по промежутку дат.  <span class="label bg-color-blueLight pull-right">false</span></dd>
</dl>        </div>   
        
        <div class="tab-pane" id="f-timestamp">
            <p class="alert alert-danger">На данный момент поддерживается <code>TIMESTAMP</code> исключительно от <code><a href="https://mariadb.org/" target="_blank">MariaDB</a></code>.</p>
<p>
    Поле типа <code>timestamp</code>.<br>
    Внешне функционирует как и <code>datetime</code>.<br>
    Дополнительные опции:
</p>

<pre><code class="php hljs">
<span class="hljs-string">'show_date'</span> =&gt; <span class="hljs-keyword">array</span>(
    <span class="hljs-comment">// ...</span>
    <span class="hljs-string">'months'</span>   =&gt; <span class="hljs-number">2</span>,
    <span class="hljs-string">'is_range'</span> =&gt; <span class="hljs-keyword">true</span>
),
</code>
</pre>            

<dl class="dl-horizontal">
  <dt>months</dt>
  <dd>Количетво отображаемых месяцев в форме редактирования и создания.  <span class="label bg-color-blueLight pull-right">1</span></dd>
  <dt>is_range</dt>
  <dd>Признак фильтрации по промежутку дат.  <span class="label bg-color-blueLight pull-right">false</span></dd>
</dl>        </div>        
        
        <div class="tab-pane" id="f-image">
            <p>
                Поле типа <code>image</code>.<br>
                Имеет два вида отображения и функционрования:<br><br>
                1. Опции для единичной загрузки изображения:
            </p>
<pre><code class="php hljs">
<span class="hljs-string">'image'</span> =&gt; <span class="hljs-keyword">array</span>(
    <span class="hljs-comment">// ...</span>
    <span class="hljs-string">'is_upload'</span>   =&gt; <span class="hljs-keyword">true</span>,
    <span class="hljs-string">'is_remote'</span>   =&gt; <span class="hljs-keyword">false</span>,
    <span class="hljs-string">'img_height'</span>  =&gt; <span class="hljs-string">'100px'</span>,
    <span class="hljs-string">'before_link'</span> =&gt; <span class="hljs-string">'http://site.com/img/'</span>,
    <span class="hljs-string">'after_link'</span>  =&gt; <span class="hljs-string">'?s=350'</span>,
),
</code>
</pre>            
            
            <dl class="dl-horizontal">
              <dt>is_upload</dt>
              <dd>Флаг для указания, что изображение загружается, иначе отображется текстовым полем.  <span class="label bg-color-blueLight pull-right">false</span></dd>
              <dt>is_remote</dt>
              <dd>Признак для построения ссылки на изображение (предпочтительно не указывать, если изображения загружается).  <span class="label bg-color-blueLight pull-right">false</span></dd>
              <dt>img_height</dt>
              <dd>Высота отображаемого изображения.  <span class="label bg-color-blueLight pull-right">50px</span></dd>
              <dt>before_link</dt>
              <dd>Префикс к ссылке отображаемого изображения.  <span class="label bg-color-blueLight pull-right">пустое</span></dd>
              <dt>after_link</dt>
              <dd>Постфикс к ссылке отображаемого изображения.  <span class="label bg-color-blueLight pull-right">пустое</span></dd>
            </dl>
            
            <p>Изображение сохранится в <code>JSON</code></p>
<pre><code class="json hljs">
{
  "<span class="hljs-attribute">alt</span>": <span class="hljs-value"><span class="hljs-string">"Such wow"</span></span>,
  "<span class="hljs-attribute">title</span>": <span class="hljs-value"><span class="hljs-string">"Much amaze"</span></span>,
  "<span class="hljs-attribute">sizes</span>": <span class="hljs-value">{
    "<span class="hljs-attribute">original</span>": <span class="hljs-value"><span class="hljs-string">"/storage/products/01/25/44/image_0.jpg"</span>
  </span>}
</span>}
</code>
</pre>  
            
            <hr>
            
            <p>2. Доп.опции для множественной загрузки изображений:</p>
<pre><code class="php hljs">
<span class="hljs-string">'images'</span> =&gt; <span class="hljs-keyword">array</span>(
    <span class="hljs-comment">// ...</span>
    <span class="hljs-string">'is_multiple'</span> =&gt; <span class="hljs-keyword">true</span>,
    <span class="hljs-string">'is_upload'</span>   =&gt; <span class="hljs-keyword">true</span>,
),
</code>
</pre>            
            
            <dl class="dl-horizontal">
              <dt>is_multiple</dt>
              <dd>Флаг для указания, что используется множественная загрузка.  <span class="label bg-color-blueLight pull-right">false</span></dd>
            </dl>    
            
             
            <p>Изображения сохранится в <code>JSON</code>, но немного иначе</p>
<pre><code class="json hljs">
[
  {
    "<span class="hljs-attribute">alt</span>": <span class="hljs-value"><span class="hljs-string">"First"</span></span>,
    "<span class="hljs-attribute">title</span>": <span class="hljs-value"><span class="hljs-string">"First"</span></span>,
    "<span class="hljs-attribute">sizes</span>": <span class="hljs-value">{
      "<span class="hljs-attribute">original</span>": <span class="hljs-value"><span class="hljs-string">"/storage/products/01/25/44/image_0.jpg"</span>
    </span>}
  </span>},
  {
    "<span class="hljs-attribute">alt</span>": <span class="hljs-value"><span class="hljs-string">"Second"</span></span>,
    "<span class="hljs-attribute">title</span>": <span class="hljs-value"><span class="hljs-string">"Second"</span></span>,
    "<span class="hljs-attribute">sizes</span>": <span class="hljs-value">{
      "<span class="hljs-attribute">original</span>": <span class="hljs-value"><span class="hljs-string">"/storage/products/01/25/44/image_1.jpg"</span>
    </span>}
  </span>}
]
</code>
</pre>             
            
            <hr>
            
            <p>Также есть возможность сохранять дополнительные версии загружаемого изображения.<br>
               Пример!<br>
               Предположим, что мы любим актрису <abbr title="помимо этого еще и писателя, фотографа, музыканта и соц.деятеля">Сашу Грей</abbr> и пиксельные изображения. Сделаем миниатюру загружаемой фотки нашей актрисы более серой и пиксельной:
            </p>
<pre><code class="php hljs">
<span class="hljs-string">'image'</span> =&gt; <span class="hljs-keyword">array</span>(
    <span class="hljs-comment">// ...</span>
    <span class="hljs-string">'variations'</span> =&gt; <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'thumb'</span> =&gt; <span class="hljs-keyword">array</span>(
            <span class="hljs-string">'resize'</span>    =&gt; <span class="hljs-keyword">array</span>(<span class="hljs-number">30</span>, <span class="hljs-number">20</span>),
            <span class="hljs-string">'greyscale'</span> =&gt; <span class="hljs-keyword">array</span>(),
            <span class="hljs-string">'pixelate'</span>  =&gt; <span class="hljs-keyword">array</span>(<span class="hljs-number">12</span>)
        )
    ),
    <span class="hljs-string">'quality'</span> =&gt; <span class="hljs-number">90</span>
),
</code>
</pre>              
                    <dl class="dl-horizontal">
                      <dt>variations</dt>
                      <dd>Список дополнительных вариантов загружаемого изображения.  <span class="label bg-color-blueLight pull-right">будет только original</span><br>
                          Ключем мы задаем идентификатор варианта изображения. В значении перечисляем методы с массивом передаваемых в них значений (<a target="_blank" href="http://image.intervention.io/">список всех методов</a>).
                      </dd>
                      <dt>quality</dt>
                      <dd>Качество сохраненных изображений.  <span class="label bg-color-blueLight pull-right">100</span><br>
                      </dd>
                    </dl>    


                        <p>В итоге мы получим:</p>
<pre><code class="json hljs">
{
  "<span class="hljs-attribute">alt</span>": <span class="hljs-value"><span class="hljs-string">"Much grey"</span></span>,
  "<span class="hljs-attribute">title</span>": <span class="hljs-value"><span class="hljs-string">"So pixel"</span></span>,
  "<span class="hljs-attribute">sizes</span>": <span class="hljs-value">{
    "<span class="hljs-attribute">original</span>": <span class="hljs-value"><span class="hljs-string">"/storage/products/01/25/44/image_0.jpg"</span></span>,
    "<span class="hljs-attribute">thumb</span>": <span class="hljs-value"><span class="hljs-string">"/storage/products/01/25/44/image_0_thumb.jpg"</span>
  </span>}
</span>}
</code>
</pre>   
                    <p>Аналогично и для множественной загрузки.</p>
                    <hr>
            
            
            <p class="alert alert-info">Описание удобного доставания изображений смотреть во вкладке трейтов.</p>
                
        </div>  
            
        <div class="tab-pane" id="f-file">
            <p>
    Поле типа <code>file</code>.<br>
    Дополнительные опции:<br>
    <span class="txt-color-magenta">Да никаких. Бери и загружай.</span>
</p>    
        </div>       
        
        <div class="tab-pane" id="f-foreign">
            <p>
    Отображение внешнего ключа.<br>
    Пример:
</p>
    
<pre><code class="php hljs">
<span class="hljs-string">'id_city'</span> =&gt; <span class="hljs-keyword">array</span>(
    <span class="hljs-string">'caption'</span> =&gt; <span class="hljs-string">'Город'</span>,
    <span class="hljs-string">'type'</span>    =&gt; <span class="hljs-string">'foreign'</span>,
    <span class="hljs-string">'filter'</span>  =&gt; <span class="hljs-string">'text'</span>,
    <span class="hljs-string">'is_null'</span> =&gt; <span class="hljs-keyword">true</span>,
    <span class="hljs-string">'null_caption'</span> =&gt; <span class="hljs-string">'Без города'</span>,
    <span class="hljs-string">'is_readonly'</span>  =&gt; <span class="hljs-keyword">false</span>,
    <span class="hljs-string">'alias'</span>        =&gt; <span class="hljs-string">'c'</span>,
    <span class="hljs-string">'foreign_table'</span>       =&gt; <span class="hljs-string">'cities'</span>,
    <span class="hljs-string">'foreign_key_field'</span>   =&gt; <span class="hljs-string">'id'</span>,
    <span class="hljs-string">'foreign_value_field'</span> =&gt; <span class="hljs-string">'name'</span>,
),
</code>
</pre>            
    
<dl class="dl-horizontal">
  <dt>is_null</dt>
  <dd>Если внешний ключ может быть <code>NULL</code>. Делается не <code>INNER JOIN</code>, а <code>LEFT JOIN</code>. <span class="label bg-color-blueLight pull-right">false</span></dd>
  <dt>null_caption</dt>
  <dd>Отображение для поля со значением <code>NULL</code>. <span class="label bg-color-blueLight pull-right">...</span><span style="margin-right:3px;" class="label bg-color-blueLight pull-right">fa-minus</span></dd>
  <dt>is_readonly</dt>
  <dd>Редактируем ли внешний ключ. <span class="label bg-color-blueLight pull-right">false</span></dd>
  <dt>alias</dt>
  <dd>Псевдоним для внешней таблицы при построении запроса. <span class="label bg-color-red pull-right">желательно</span><br>
      Особенно важен, если таблица ссылается на саму себя.</dd>
  <dt>foreign_table</dt>
  <dd>Название внешней таблицы. <span class="label bg-color-red pull-right">обязательно</span></dd>
  <dt>foreign_key_field</dt>
  <dd>Ключ внешней таблицы, на который ссылается данное поле. <span class="label bg-color-red pull-right">обязательно</span></dd>
  <dt>foreign_value_field</dt>
  <dd>Значение из внешней таблицы, которое подтянется вместо идентификатора текущей таблицы. <span class="label bg-color-red pull-right">обязательно</span></dd>
</dl>    
        </div>    
        
        <div class="tab-pane active" id="f-many2many">
            <p>
    Отображение связи многое-ко-многим.<br>
    Пример:
</p>

<p class="alert alert-danger">Для <code>many2many</code> вместо идентификатора поля пишется любое значение, начинающееся с <code>many2many</code>, чтобы импользовать несколько <code>many2many</code> в одной форме.</p>

<pre><code class="php hljs">
<span class="hljs-comment">// текущая таблица filials</span>
<span class="hljs-string">'many2many'</span> =&gt; <span class="hljs-keyword">array</span>(
    <span class="hljs-string">'caption'</span>   =&gt; <span class="hljs-string">'Предоставляемые услуги'</span>,
    <span class="hljs-string">'type'</span>      =&gt; <span class="hljs-string">'many_to_many'</span>,
    <span class="hljs-string">'show_type'</span> =&gt; <span class="hljs-string">'select2'</span>,
    <span class="hljs-string">'hide_list'</span> =&gt; <span class="hljs-keyword">true</span>,
    <span class="hljs-string">'mtm_table'</span>                      =&gt; <span class="hljs-string">'filials2services'</span>,
    <span class="hljs-string">'mtm_key_field'</span>                  =&gt; <span class="hljs-string">'id_filial'</span>,  <span class="hljs-comment">// filials2catalog.id_filial</span>
    <span class="hljs-string">'mtm_external_foreign_key_field'</span> =&gt; <span class="hljs-string">'id'</span>,         <span class="hljs-comment">// services.id</span>
    <span class="hljs-string">'mtm_external_key_field'</span>         =&gt; <span class="hljs-string">'id_service'</span>, <span class="hljs-comment">// filials2services.id_service</span>
    <span class="hljs-string">'mtm_external_value_field'</span>       =&gt; <span class="hljs-string">'name'</span>,       <span class="hljs-comment">// services.name</span>
    <span class="hljs-string">'mtm_external_table'</span>             =&gt; <span class="hljs-string">'services'</span>,
    <span class="hljs-string">'divide_columns'</span>   =&gt; <span class="hljs-number">3</span>,
    <span class="hljs-string">'additional_where'</span> =&gt; <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'services.is_active'</span> =&gt; <span class="hljs-keyword">array</span>(
            <span class="hljs-string">'sign'</span>  =&gt; <span class="hljs-string">'='</span>,
            <span class="hljs-string">'value'</span> =&gt; <span class="hljs-string">'1'</span>
        )
    ),
    <span class="hljs-string">'extra_fields'</span> =&gt; <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'price'</span> =&gt; <span class="hljs-keyword">array</span>(  <span class="hljs-comment">// filials2services.price</span>
            <span class="hljs-string">'caption'</span> =&gt; <span class="hljs-string">'Вариант'</span>,
            <span class="hljs-string">'type'</span>    =&gt; <span class="hljs-string">'text'</span>,
        )
    ),
),
</code>
</pre>

<dl class="dl-horizontal">
  <dt>show_type</dt>
  <dd>Тип отображения поля (<code>checkbox|select2|extra</code>). <span class="label bg-color-blueLight pull-right">checkbox</span></dd>
  <dt>divide_columns</dt>
  <dd>Количество колонок для внешних ключей (применимо для <code>show_type = checkbox</code>). <span class="label bg-color-blueLight pull-right">2</span></dd>
  <dt>additional_where</dt>
  <dd>Дополнительные <code>WHERE</code> запросы для выборки. <span class="label bg-color-blueLight pull-right">без доп.условий</span></dd>
  <dt>mtm_table</dt>
  <dd>Таблица связей. <span class="label bg-color-red pull-right">обязательно</span></dd>
  <dt>mtm_key_field</dt>
  <dd>Название ключа таблицы связей, ссылающийся на текущее поле. <span class="label bg-color-red pull-right">обязательно</span></dd>
  <dt>mtm_external_foreign_key_field</dt>
  <dd>Внешний ключ из таблицы <code>mtm_external_table</code> на который ссылается <code>mtm_external_key_field</code>. <span class="label bg-color-red pull-right">обязательно</span></dd>
  <dt>mtm_external_key_field</dt>
  <dd>Название ключа таблицы связей, ссылающийся на поле из второй таблицы связей <code>mtm_external_table</code>. <span class="label bg-color-red pull-right">обязательно</span></dd>
  <dt>mtm_external_value_field</dt>
  <dd>Значение, которое подтянется на фронтенд из таблицы <code>mtm_external_table</code> по полю <code>mtm_external_foreign_key_field</code>. <span class="label bg-color-red pull-right">обязательно</span></dd>
  <dt>mtm_external_table</dt>
  <dd>Название таблицы, на которую ссылается внешний ключ таблицы связей, который не является текущей таблицей.<span class="label bg-color-red pull-right">обязательно</span></dd>
  <dt>extra_fields</dt>
  <dd>Используется только при <code>show_type =&gt; extra</code>. В ключе название поля, которое находится в таблице связей. В значении его два параметра (пока <code>type</code> только <code>text</code>). <span class="label bg-color-red pull-right">обязательно при extra</span></dd>
</dl>

<p>Слегка мутно. Строения таблиц из примера:</p>
<code>
<pre>filials          - |id|...|
services         - |id|name|...|
filials2services - |id|id_filial|id_service|
</pre>
</code>    
        </div>   
        
        <div class="tab-pane" id="f-color">
            <p>
    Пикер цвета.<br>
    Дополнительные опции:
</p>

<pre><code class="php hljs">
<span class="hljs-string">'color'</span> =&gt; <span class="hljs-keyword">array</span>(
    <span class="hljs-string">'caption'</span>    =&gt; <span class="hljs-string">'Цвет'</span>,
    <span class="hljs-string">'type'</span>       =&gt; <span class="hljs-string">'color'</span>,
    <span class="hljs-string">'color_type'</span> =&gt; <span class="hljs-string">'rgba'</span>,
    <span class="hljs-string">'default'</span>    =&gt; <span class="hljs-string">'rgba(110,28,51,0.57)'</span>,
)
</code>
</pre>            

<dl class="dl-horizontal">
  <dt>color_type</dt>
  <dd>Тип хранения цвета <code>hex|rgba</code>. <span class="label bg-color-blueLight pull-right">hex</span></dd>
  <dt>default</dt>
  <dd>Значение цвета по умоланию. <span class="label bg-color-blueLight pull-right">ничего</span></dd>
</dl>    
        </div>   
        
        <div class="tab-pane" id="f-custom">
            <p class="alert alert-warning">Формирование кастомного поля довольно сырое. Предложения приветствуются.</p>

<p>
    Иногда перед нами ставят задачи, которые не <abbr title="на этом моменте бывшие разработчики альфабанка и сушии должны разразиться смехом и спросить: 'нахуа?'.">решить элегантно</abbr>.<br>
    Поэтому у нас есть кастомное поле, в которое мы можем впихнуть все что душе угодно:
</p>
    
<pre><code class="php hljs">
<span class="hljs-string">'custom'</span> =&gt; <span class="hljs-keyword">array</span>(
    <span class="hljs-string">'caption'</span> =&gt; <span class="hljs-string">'Кастомное поле'</span>,
    <span class="hljs-string">'type'</span>    =&gt; <span class="hljs-string">'custom'</span>,
)
</code>
</pre>            
    
<p>Откуда берутся значения и представление для него? Куда оно записывается, и записывается ли вообще?</p>
<p>Это мы все описываем в переопределенной паре методов нашего хендлера:</p>

<pre><code class="php hljs">
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onSearchCustomFilter</span><span class="hljs-params">(<span class="hljs-variable">$formField</span>, &amp;<span class="hljs-variable">$db</span>, <span class="hljs-variable">$value</span>)</span>
</span>{
} <span class="hljs-comment">// end onSearchCustomFilter</span>

<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onGetCustomValue</span><span class="hljs-params">(<span class="hljs-variable">$formField</span>, array &amp;<span class="hljs-variable">$row</span>, &amp;<span class="hljs-variable">$postfix</span>)</span>
</span>{
} <span class="hljs-comment">// end onGetCustomValue</span>

<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onGetCustomEditInput</span><span class="hljs-params">(<span class="hljs-variable">$formField</span>, array &amp;<span class="hljs-variable">$row</span>)</span>
</span>{
} <span class="hljs-comment">// end onGetCustomEditInput</span>
    
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onGetCustomListValue</span><span class="hljs-params">(<span class="hljs-variable">$formField</span>, array &amp;<span class="hljs-variable">$row</span>)</span>
</span>{
} <span class="hljs-comment">// end onGetCustomListValue</span>

<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onSelectCustomValue</span><span class="hljs-params">(&amp;<span class="hljs-variable">$db</span>)</span>
</span>{
} <span class="hljs-comment">// end onSelectCustomValue</span>
</code>
</pre> 

    
<dl class="dl-horizontal">
  <dt>onSearchCustomFilter</dt>
  <dd>Разруливаете поиск по своему полю.</dd>
  <dt>onGetCustomValue</dt>
  <dd>Получение значения поля.</dd>
  <dt>onGetCustomEditInput</dt>
  <dd>Возвращаемый <code>html</code> отображается в формах создания и редактирования.</dd>
  <dt>onGetCustomListValue</dt>
  <dd>Возвращаемое значение отображается в таблице.</dd>
  <dt>onSelectCustomValue</dt>
  <dd>Для изменения выборки.</dd>
</dl>

    
        </div>  
        
        <div class="tab-pane" id="f-pattern">
            <p>Внедряемые шаблончики:</p>

<pre><code class="php hljs">
<span class="hljs-string">'pattern.example'</span> =&gt; <span class="hljs-keyword">array</span>(),
</code>
</pre>    

<p>Название паттерна всегда должно начинаться с <code>pattern.</code>, 
после чего идет уже наименование самого паттерна, который (в данном примере) 
находится в <code>/app/tb-definitions/patterns/example.php</code></p>

<hr>

<p>Структура паттерна:</p>
<pre><code class="php hljs">
<span class="hljs-keyword">return</span> <span class="hljs-keyword">array</span>(

    <span class="hljs-string">'install'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-comment">// пока не используется</span>
    }, <span class="hljs-comment">// end install</span>
    
    <span class="hljs-string">'view'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(array <span class="hljs-variable">$row</span>)</span> </span>{ <span class="hljs-comment">// $row пустой, если это форма на создание записи</span>
        <span class="hljs-comment">// все имена инпутов необходимо делать по шаблону - pattern[this_pattern_name][my_input_name]</span>
        <span class="hljs-variable">$val</span> = <span class="hljs-variable">$row</span> ? <span class="hljs-variable">$row</span>[<span class="hljs-string">'id'</span>] : <span class="hljs-string">''</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-string">'&lt;input name="pattern[example][text]" value="'</span>. <span class="hljs-variable">$val</span> .<span class="hljs-string">'"&gt;'</span>;
    }, <span class="hljs-comment">// end view</span>
    
    <span class="hljs-comment">// обработчики паттерна. в $values находятся все значения формы</span>
    <span class="hljs-string">'handle'</span> =&gt; <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'insert'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(<span class="hljs-variable">$values</span>, <span class="hljs-variable">$idRow</span>)</span> </span>{
            
        }, <span class="hljs-comment">// end insert</span>
        
        <span class="hljs-string">'update'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(<span class="hljs-variable">$values</span>, <span class="hljs-variable">$idRow</span>)</span> </span>{
            <span class="hljs-comment">// dr($values);</span>
        }, <span class="hljs-comment">// end update</span>
        
        <span class="hljs-string">'delete'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(<span class="hljs-variable">$idRow</span>)</span> </span>{
            
        }, <span class="hljs-comment">// end delete</span>
    ),
);
</code>
</pre>      
        </div>    
        
    </div>
</div>        </div>
    </div>
    <div class="tab-pane" id="callbacks">
        <div class="table-responsive">
            <p class="alert alert-info">Не хватает? Сообщаем.</p>

<p>Коллбеки в построении таблиц служат для расширения обработки данных таблицы под специфические нужды без прямого вмешательства в функционирующий код.</p>
<hr>

<p>Установка хендлера с коллебками за пару шагов:</p>
<ol>
    <li>Прописать в описании таблицы <code>'handler' =&gt; 'MyCustomTableHandler'</code>.</li>
    <li>Создать сам класс хендлера и унаследовать его от <code>Yaro\TableBuilder\Handlers\CustomHandler</code>.</li>
    <li>Радоваться.</li>
</ol>
<hr>

<p>Методы, которыми можно вмешаться в волшебный ход событий:</p>

<ol>
<li>
    <code>handle()</code>
    <p>Вызывается перед каждым действием. И если есть возвращаемое значение, то остальной код не исполняется. Мутите все сами.</p>
<pre><code class="php hljs">            
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handle</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">die</span>(<span class="hljs-string">'what am I doing here?'</span>);
} <span class="hljs-comment">// end handle</span>
</code>
</pre>  
</li>

<li>
    <code>onGetValue($formField, array &amp;$row, &amp;$postfix)</code>
    <p>Вызывается перед каждым получением значения поля. Возвращаемое значение прекращает продолжение логического блока.</p>
    <dl class="dl-horizontal">
      <dt>$formField</dt>
      <dd>Объект поля.</dd>
      <dt>$row</dt>
      <dd>Массив значений поля на текущий момент.</dd>
      <dt>$postfix</dt>
      <dd>Постфикс поля (при использовании табов).</dd>
    </dl>
<pre><code class="php hljs">            
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onGetValue</span><span class="hljs-params">(<span class="hljs-variable">$formField</span>, array &amp;<span class="hljs-variable">$row</span>, &amp;<span class="hljs-variable">$postfix</span>)</span>
</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">'wtf'</span>;
} <span class="hljs-comment">// end onGetValue</span>
</code>
</pre>  
</li>

<li>
    <code>onGetExportValue($formField, $type, array &amp;$row, &amp;$postfix)</code>
    <p>Вызывается перед каждым получением значения при экспорте. Возвращаемое значение прекращает продолжение логического блока.</p>
    <dl class="dl-horizontal">
      <dt>$type</dt>
      <dd>Тип экспорта.</dd>
    </dl>
</li>

<li>
    <code>onGetEditInput($formField, array &amp;$row)</code>
    <p>Вызывается перед каждым получением <code>html</code> для поля. Возвращаемое значение прекращает продолжение логического блока.</p>
</li>

<li>
    <code>onGetListValue($formField, array &amp;$row)</code>
    <p>Вызывается перед каждым получением значения поля для вывода его в таблицу. Возвращаемое значение прекращает продолжение логического блока.</p>
</li>

<li>
    <code>onPrepareSearchFilters(array &amp;$filters)</code>
    <p>Вызывается после формирования значений фильтра по таблице и перед сохранением их в сессию.</p>
    <dl class="dl-horizontal">
      <dt>$filters</dt>
      <dd>Массив фильтров пользователя.</dd>
    </dl>
<pre><code class="php hljs">            
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onPrepareSearchFilters</span><span class="hljs-params">(array &amp;<span class="hljs-variable">$filters</span>)</span>
</span>{
    <span class="hljs-variable">$filters</span> = <span class="hljs-keyword">array</span>();
} <span class="hljs-comment">// end onPrepareSearchFilters</span>
</code>
</pre> 
</li>

<li>
    <code>onSearchFilter(&amp;$db, $name, $value)</code>
    <p>Вызывается на каждой итерации при формировании выборки по фильтрам. Возвращаемое значение прерывает выполнение логического блока на текущей итерации.</p>
    <dl class="dl-horizontal">
      <dt>$db</dt>
      <dd>Инстанс <code>Fluent</code>.</dd>
      <dt>$name</dt>
      <dd>Поле для выборки.</dd>
      <dt>$value</dt>
      <dd>Значение поля для выборки.</dd>
    </dl>
<pre><code class="php hljs">            
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onSearchFilter</span><span class="hljs-params">(&amp;<span class="hljs-variable">$db</span>, <span class="hljs-variable">$name</span>, <span class="hljs-variable">$value</span>)</span>
</span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$name</span> == <span class="hljs-string">'title'</span>) {
        <span class="hljs-variable">$db</span>-&gt;where(<span class="hljs-variable">$name</span>, <span class="hljs-string">'LIKE'</span>, <span class="hljs-string">'%котики%'</span>);
    }
} <span class="hljs-comment">// end onSearchFilter</span>
</code>
</pre> 
</li>

<li>
    <code>onUpdateRowResponse(array &amp;$response)</code>
    <p>Вызывается после обновления поля.</p>
    <dl class="dl-horizontal">
      <dt>$response</dt>
      <dd>Массив из двух ключей:</dd>
      <dd><b>id</b> - значение первичного ключа обновленного поля.</dd>
      <dd><b>values</b> - массив подготовленных значений, что были задествованы при обновлении поля.</dd>
    </dl>
<pre><code class="php hljs">            
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onUpdateRowResponse</span><span class="hljs-params">(array &amp;<span class="hljs-variable">$response</span>)</span>
</span>{
    Cache::forget(<span class="hljs-string">'my_saved_key'</span>);
} <span class="hljs-comment">// end onUpdateRowResponse</span>
</code>
</pre> 
</li>

<li>
    <code>onInsertRowResponse(array &amp;$response)</code>
    <p>Вызывается после создания поля. Все как и при <code>onUpdateRowResponse</code>.</p>
</li>

<li>
    <code>onDeleteRowResponse(array &amp;$response)</code>
    <p>Вызывается после удаления поля.</p>
    <dl class="dl-horizontal">
      <dt>$response</dt>
      <dd>Массив из двух ключей:</dd>
      <dd><b>id</b> - значение первичного ключа удаленного поля.</dd>
      <dd><b>status</b> - значение, что возвращает <code>Fluent</code> при вызове <code>delete()</code>.</dd>
    </dl>
</li>

<li>
    <code>handleDeleteRow($id)</code>
    <p>Переопределение полностью всей логики по удалению. Возвращаемое значение прерывает логический блок.</p>
    <dl class="dl-horizontal">
      <dt>$id</dt>
      <dd>Первичный ключ поля на удаление.</dd>
    </dl>
<pre><code class="php hljs">            
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleDeleteRow</span><span class="hljs-params">(<span class="hljs-variable">$id</span>)</span>
</span>{
    <span class="hljs-comment">// do something</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'id'</span>     =&gt; <span class="hljs-variable">$id</span>,
        <span class="hljs-string">'status'</span> =&gt; <span class="hljs-keyword">true</span>
    );
} <span class="hljs-comment">// end handleDeleteRow</span>
</code>
</pre> 
</li>

<li>
    <code>handleInsertRow($values)</code>
    <p>Переопределение полностью всей логики по созданию поля. Возвращаемое значение прерывает логический блок.</p>
    <dl class="dl-horizontal">
      <dt>$values</dt>
      <dd>Массив значений из формы создания.</dd>
    </dl>
<pre><code class="php hljs">            
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleInsertRow</span><span class="hljs-params">(<span class="hljs-variable">$values</span>)</span>
</span>{
    <span class="hljs-comment">// do something</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'id'</span> =&gt; <span class="hljs-variable">$idInsertedRow</span>,
        <span class="hljs-string">'values'</span> =&gt; <span class="hljs-variable">$values</span>
    );
} <span class="hljs-comment">// end handleInsertRow</span>
</code>
</pre> 
</li>

<li>
    <code>handleUpdateRow($values)</code>
    <p>Переопределение полностью всей логики по обновлению поля. Возвращаемое значение прерывает логический блок.</p>
<pre><code class="php hljs">            
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleUpdateRow</span><span class="hljs-params">(<span class="hljs-variable">$values</span>)</span>
</span>{
    <span class="hljs-comment">// do something</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'id'</span> =&gt; <span class="hljs-variable">$idUpdatedRow</span>,
        <span class="hljs-string">'values'</span> =&gt; <span class="hljs-variable">$values</span>
    );
} <span class="hljs-comment">// end handleUpdateRow</span>
</code>
</pre> 
</li>

<li>
    <code>onInsertRowData(array &amp;$data)</code>
    <p>Переопределение логики по созданию поля. Вызывается перед валидацией и добавлении значений фильтра. Возвращаемое значение прерывает логический блок по созданию поля.</p>
    <dl class="dl-horizontal">
      <dt>$data</dt>
      <dd>Массив подготовленных значений из формы.</dd>
    </dl>
<pre><code class="php hljs">            
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onInsertRowData</span><span class="hljs-params">(array &amp;<span class="hljs-variable">$data</span>)</span>
</span>{
    <span class="hljs-comment">// do something</span>
    <span class="hljs-keyword">return</span> <span class="hljs-variable">$idInsertedRow</span>;
} <span class="hljs-comment">// end handleUpdateRow</span>
</code>
</pre> 
</li>

<li>
    <code>onUpdateRowData(array &amp;$data)</code>
    <p>Дополнение логики по обновлению поля. Вызывается после проверки значений формы и перед их валидацией.</p>
</li>

        
<li>
    <p>Методы для определения работы поля типа <code>custom</code>.</p>    
<pre><code class="php hljs">       
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onSearchCustomFilter</span><span class="hljs-params">(<span class="hljs-variable">$formField</span>, &amp;<span class="hljs-variable">$db</span>, <span class="hljs-variable">$value</span>)</span>
</span>{
} <span class="hljs-comment">// end onSearchCustomFilter</span>

<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onGetCustomValue</span><span class="hljs-params">(<span class="hljs-variable">$formField</span>, array &amp;<span class="hljs-variable">$row</span>, &amp;<span class="hljs-variable">$postfix</span>)</span>
</span>{
} <span class="hljs-comment">// end onGetCustomValue</span>

<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onGetCustomEditInput</span><span class="hljs-params">(<span class="hljs-variable">$formField</span>, array &amp;<span class="hljs-variable">$row</span>)</span>
</span>{
} <span class="hljs-comment">// end onGetCustomEditInput</span>
    
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onGetCustomListValue</span><span class="hljs-params">(<span class="hljs-variable">$formField</span>, array &amp;<span class="hljs-variable">$row</span>)</span>
</span>{
} <span class="hljs-comment">// end onGetCustomListValue</span>

<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onSelectCustomValue</span><span class="hljs-params">(&amp;<span class="hljs-variable">$db</span>)</span>
</span>{
} <span class="hljs-comment">// end onSelectCustomValue</span>
</code>
</pre> 
</li>

<li>
    <code>onFileUpload($file)</code>
    <p>Переопределение логики манипуляций при загрузке файла. Возвращаемое значение прерывает полностью весь блок логики по сохранению файла.</p>
    <dl class="dl-horizontal">
      <dt>$file</dt>
      <dd>Объект <code>Symfony\Component\HttpFoundation\File\UploadedFile</code> с загружаемым файлом.</dd>
    </dl>
<pre><code class="php hljs">     
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onFileUpload</span><span class="hljs-params">(<span class="hljs-variable">$file</span>)</span>
</span>{
    <span class="hljs-comment">// do something</span>
    <span class="hljs-variable">$data</span> = <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'status'</span>     =&gt; <span class="hljs-keyword">true</span>, <span class="hljs-comment">// false</span>
        <span class="hljs-string">'link'</span>       =&gt; <span class="hljs-variable">$absolutePath</span>,
        <span class="hljs-string">'short_link'</span> =&gt; <span class="hljs-variable">$relativePath</span>,
    );
    <span class="hljs-keyword">return</span> Response::json(<span class="hljs-variable">$data</span>);
} <span class="hljs-comment">// end onFileUpload</span>
</code>
</pre>  
</li>


<li>
    <code>onPhotoUpload($formField, $file)</code>
    <p>Переопределение логики манипуляций при загрузке изображения. Возвращаемое значение прерывает полностью весь блок логики по сохранению и обработке изображения.</p>
<pre><code class="php hljs">     
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onPhotoUpload</span><span class="hljs-params">(<span class="hljs-variable">$formField</span>, <span class="hljs-variable">$file</span>)</span>
</span>{
    <span class="hljs-variable">$data</span> = <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'status'</span>     =&gt; <span class="hljs-keyword">true</span>, <span class="hljs-comment">// false</span>
        <span class="hljs-string">'link'</span>       =&gt; <span class="hljs-variable">$absolutePath</span>,
        <span class="hljs-string">'short_link'</span> =&gt; <span class="hljs-variable">$relativePath</span>,
    );
    <span class="hljs-keyword">return</span> Response::json(<span class="hljs-variable">$data</span>);
} <span class="hljs-comment">// end onPhotoUpload</span>
</code>
</pre>  
</li>

<li>
    <code>onPhotoUploadFromWysiwyg($file)</code>
    <p>Переопределение логики загрузки изображения через WYSIWYG-редактор. Возвращаемое значение прерывает полностью весь блок логики по сохранению изображения через редактор.</p>
<pre><code class="php hljs">     
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onPhotoUploadFromWysiwyg</span><span class="hljs-params">(<span class="hljs-variable">$file</span>)</span>
</span>{
    <span class="hljs-variable">$data</span> = <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'status'</span> =&gt; <span class="hljs-keyword">true</span>, <span class="hljs-comment">// false</span>
        <span class="hljs-string">'link'</span>   =&gt; <span class="hljs-variable">$absolutePath</span>,
    );
    <span class="hljs-keyword">return</span> Response::json(<span class="hljs-variable">$data</span>);
} <span class="hljs-comment">// end onPhotoUploadFromWysiwyg</span>
</code>
</pre>  
</li>

<li>
    <code>onInsertButtonFetch($def)</code>
    <p>Переопределение логики формирования <code>html</code> для кнопки создания поля. Возвращаемое значение прерывает логический блок.</p>
    <dl class="dl-horizontal">
      <dt>$def</dt>
      <dd>Описания настроек для данной кнопки.</dd>
    </dl>
<pre><code class="php hljs">     
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onInsertButtonFetch</span><span class="hljs-params">(<span class="hljs-variable">$def</span>)</span>
</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">'&lt;p&gt;hai&lt;/p&gt;'</span>;
} <span class="hljs-comment">// end onInsertButtonFetch</span>
</code>
</pre>  
</li>

<li>
    <code>onUpdateButtonFetch($def)</code>
    <p>Переопределение логики формирования <code>html</code> для кнопки редактирования поля. Возвращаемое значение прерывает логический блок.</p>
</li>

<li>
    <code>onDeleteButtonFetch($def)</code>
    <p>Переопределение логики формирования <code>html</code> для кнопки удаления поля. Возвращаемое значение прерывает логический блок.</p>
</li>

</ol>

        </div>
    </div>
    <div class="tab-pane" id="traits">
        <div class="table-responsive">
            <div class="tabs-left">
    <ul class="nav nav-tabs tabs-left p-abs">
        <li class="active">
            <a href="#t-images" data-toggle="tab"> Image </a>
        </li>
        <li class="">
            <a href="#t-translate" data-toggle="tab"> Translate </a>
        </li>
    </ul>
    <div class="tab-content min-500">
        
        <div class="tab-pane active" id="t-images">
            <p><code>use Yaro\TableBuilder\Helpers\Traits\ImageTrait;</code></p>
<p>
    Трейт для удобного вытягивания изображений.<br>
    
    Доступные методы:    
</p>

<pre><code class="php hljs">
<span class="hljs-variable">$ident</span> = <span class="hljs-string">'original'</span>; <span class="hljs-comment">// идентификатор изображения</span>

<span class="hljs-comment">// поле единичной загрузки изображения</span>
getImage(<span class="hljs-variable">$ident</span>, <span class="hljs-variable">$field</span> = <span class="hljs-string">'image'</span>);
getImageAlt(<span class="hljs-variable">$field</span> = <span class="hljs-string">'image'</span>);
getImageTitle(<span class="hljs-variable">$field</span> = <span class="hljs-string">'image'</span>);
getImageSource(<span class="hljs-variable">$ident</span>, <span class="hljs-variable">$field</span> = <span class="hljs-string">'image'</span>, <span class="hljs-variable">$default</span> = <span class="hljs-string">''</span>);

<span class="hljs-comment">// поле множественной загрузки изображений</span>
getFirstImage(<span class="hljs-variable">$ident</span>, <span class="hljs-variable">$field</span> = <span class="hljs-string">'images'</span>);
getFirstImageAlt(<span class="hljs-variable">$field</span> = <span class="hljs-string">'images'</span>);
getFirstImageTitle(<span class="hljs-variable">$field</span> = <span class="hljs-string">'images'</span>);
getFirstImageSource(<span class="hljs-variable">$ident</span>, <span class="hljs-variable">$field</span> = <span class="hljs-string">'images'</span>, <span class="hljs-variable">$default</span> = <span class="hljs-string">''</span>);
getImages(<span class="hljs-variable">$field</span> = <span class="hljs-string">'images'</span>);

</code>
</pre>            

            
        </div>
        
        <div class="tab-pane" id="t-translate">
            tr           
        </div>
        
        
        
    </div>
</div>        </div>
    </div>
    <div class="tab-pane" id="helpers">
        <div class="table-responsive">
            <div class="tabs-left">
    <ul class="nav nav-tabs tabs-left p-abs">
        <li class="active">
            <a href="#h-settings" data-toggle="tab"> Settings </a>
        </li>
        <li>
            <a href="#h-urlify" data-toggle="tab"> URLify </a>
        </li>
        <li>
            <a href="#h-translate" data-toggle="tab"> Translate </a>
        </li>
        <li>
            <a href="#h-geo" data-toggle="tab"> Geo </a>
        </li>
        <li>
            <a href="#h-helpers" data-toggle="tab"> helpers </a>
        </li>
    </ul>
    <div class="tab-content min-500">
        
        <div class="tab-pane active" id="h-settings">
            <p>
    Класс для вытягивания настроек приложения.<br>
    Доступные методы:    
</p>

<pre><code class="php hljs">
var_dump(Settings::get(<span class="hljs-string">'site_caption'</span>));
<span class="hljs-comment">// string(7) "My Site"</span>

Settings::get(<span class="hljs-string">'non_existed_ident'</span>);
<span class="hljs-comment">// @throws  RuntimeException</span>

var_dump(Settings::has(<span class="hljs-string">'non_existed_ident'</span>));
<span class="hljs-comment">// bool(false)</span>

<span class="hljs-keyword">echo</span> Settings::get(<span class="hljs-string">'pagination_variants'</span>);
<span class="hljs-comment">// string(10) "5|20 | 40 "</span>

<span class="hljs-variable">$delimiter</span> = <span class="hljs-string">'|'</span>; <span class="hljs-comment">// default is ','</span>
var_dump(Settings::getChunks(<span class="hljs-string">'pagination_variants'</span>, <span class="hljs-variable">$delimiter</span>));
<span class="hljs-comment">// array(3) { [0]=&gt; int(5) [1]=&gt; int(20) [2]=&gt; int(40) }</span>

var_dump(Settings::getFirstChunk(<span class="hljs-string">'pagination_variants'</span>, <span class="hljs-variable">$delimiter</span>));
<span class="hljs-comment">// int(5)</span>
</code>
</pre>            

            
        </div>
        
        <div class="tab-pane " id="h-urlify">
            <p>
    Используется для преобразования строки в корректную для использования в URL.<br>
</p>

<pre><code class="php hljs">
<span class="hljs-keyword">echo</span> TableBuilder::urlify(<span class="hljs-string">" J'étudie le français "</span>);
<span class="hljs-comment">// jetudie-le-francais</span>

<span class="hljs-keyword">echo</span> TableBuilder::urlify(<span class="hljs-string">'Lo siento, no hablo español.'</span>);
<span class="hljs-comment">// lo-siento-no-hablo-espanol</span>
</code>
</pre>            

      
        </div>
        
        <div class="tab-pane " id="h-translate">
            <p class="alert alert-danger">Не описаны возможности, которые в скором времени могут не функционировать в режиме обратной совместимости.</p>

<p>
    Переводы и все-все-все.<br><br>
    Переводы через Yandex (для этого нужно вписать api ключ в конфиг):
</p>

<pre><code class="php hljs">
<span class="hljs-variable">$text</span> = TableBuilder::translate(<span class="hljs-string">'Hello world'</span>, <span class="hljs-string">'en-ru'</span>);
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$text</span>;
<span class="hljs-comment">// Привет мир</span>

<span class="hljs-variable">$isHtml</span> = <span class="hljs-keyword">true</span>;
<span class="hljs-variable">$text</span> = <span class="hljs-string">'&lt;p&gt;'</span>. <span class="hljs-variable">$text</span> .<span class="hljs-string">'&lt;/p&gt;'</span>;
<span class="hljs-keyword">echo</span> TableBuilder::translate(<span class="hljs-variable">$text</span>, <span class="hljs-string">'en-uk'</span>, <span class="hljs-variable">$isHtml</span>);
<span class="hljs-comment">// &lt;p&gt;Привіт світ&lt;/p&gt;</span>

<span class="hljs-variable">$isAutoDetect</span> = <span class="hljs-number">1</span>;
<span class="hljs-keyword">echo</span>  TableBuilder::translate(<span class="hljs-string">'Привет мир'</span>, <span class="hljs-string">'en'</span>, <span class="hljs-keyword">false</span>, <span class="hljs-variable">$isAutoDetect</span>);
<span class="hljs-comment">// Hello world</span>
</code>
</pre>            

      
        </div>
        
        <div class="tab-pane " id="h-geo">
            <p class="alert alert-warning">Разбирает ip только стран постсоветского пространства.</p>

<p>
    Получения гео-информации по ip. Для использования необходима таблица по гео-координатам, которую можно создать при <code>php artisan tb::prepare</code>.<br><br>
    Пример:
</p>

<pre><code class="php hljs">
<span class="hljs-comment">// берется текущий ip</span>
var_dump(TableBuilder::geo());
<span class="hljs-comment">// bool(false)</span>

<span class="hljs-comment">// при ошибке, либо отсутствии координат по ip</span>
var_dump(TableBuilder::geo(<span class="hljs-string">'sovsem_ne_ip'</span>));
<span class="hljs-comment">// bool(false)</span>

var_dump(TableBuilder::geo(<span class="hljs-string">'217.27.152.26'</span>));
<span class="hljs-comment">// array(1) { ["217.27.152.26"]=&gt; array(3) { ["Town"]=&gt; string(8) "Киев" ["Lon"]=&gt; string(9) "30.523333" ["Lat"]=&gt; string(9) "50.450001" } }</span>
</code>
</pre>            

      
        </div>
        
        <div class="tab-pane " id="h-helpers">
            <p>
    Перечень доступных хелперов:
</p>
<br>

1. <code>dr()</code> - как и <code>dd()</code>, но <code>print_r</code> вместо <code>var_dump</code>.
<pre><code class="php hljs">
dr(<span class="hljs-variable">$array</span>);
</code>
</pre>            
<br>

2. <code>__()</code> - используется для переводов слов/фраз в шаблонах. Не передавайте половину верстки, разбивайте перевод на смысловые части. Если перевод не найден, то вернется сформироавнный передаваемый шаблон.
<pre><code class="php hljs">
<span class="hljs-comment">// простое использование</span>
__(<span class="hljs-string">'Пример'</span>);

<span class="hljs-comment">// немного сложнее</span>
__(<span class="hljs-string">'а тут %sжирно%s'</span>, <span class="hljs-string">'&lt;b&gt;'</span>, <span class="hljs-string">'&lt;/b&gt;'</span>);

<span class="hljs-comment">// немного сложнее предыдущего</span>
__(<span class="hljs-string">'Кругом не %2$s, а %1$s'</span>, <span class="hljs-string">'хламидомонады'</span>, <span class="hljs-string">'люди'</span>);
</code>
</pre>            
<br>

3. <code>cartesian()</code> - для просчета <a href="https://ru.wikipedia.org/wiki/%D0%9F%D1%80%D1%8F%D0%BC%D0%BE%D0%B5_%D0%BF%D1%80%D0%BE%D0%B8%D0%B7%D0%B2%D0%B5%D0%B4%D0%B5%D0%BD%D0%B8%D0%B5" target="_blank">декартового произведения множеств</a>.
<pre><code class="php hljs">
<span class="hljs-variable">$array</span> = <span class="hljs-keyword">array</span>(
    <span class="hljs-keyword">array</span>(<span class="hljs-number">11</span>, <span class="hljs-number">33</span>),
    <span class="hljs-keyword">array</span>(<span class="hljs-number">22</span>), 
);
<span class="hljs-variable">$isElementsDuplicated</span> = <span class="hljs-keyword">false</span>; <span class="hljs-comment">// false по дефолту</span>
<span class="hljs-variable">$result</span> = cartesian(<span class="hljs-variable">$array</span>, <span class="hljs-variable">$isElementsDuplicated</span>);

<span class="hljs-variable">$expected</span> = <span class="hljs-keyword">array</span>(
    <span class="hljs-keyword">array</span>(<span class="hljs-number">11</span>, <span class="hljs-number">22</span>),
    <span class="hljs-keyword">array</span>(<span class="hljs-number">33</span>, <span class="hljs-number">22</span>),
);
var_dump(<span class="hljs-variable">$result</span> == <span class="hljs-variable">$expected</span>);
<span class="hljs-comment">// bool(true)</span>
</code>
</pre>            
<br>


      
        </div>
        
        
        
    </div>
</div>        </div>
    </div>
    <div class="tab-pane" id="common">
        <div class="table-responsive">
            <p>Предположим, что нам нужно построить простейшую таблицу — cписок товаров.<br>
            Для начала создадим пункт меню для админ-панели. Зайдем в конфиг и допишем следующее:</p>
<pre><code class="php hljs">
<span class="hljs-keyword">array</span>(
    <span class="hljs-string">'title'</span> =&gt; <span class="hljs-string">'Товары'</span>, 
    <span class="hljs-string">'icon'</span>  =&gt; <span class="hljs-string">'th-list'</span>,  
    <span class="hljs-string">'link'</span>  =&gt; <span class="hljs-string">'/products'</span>,       
    <span class="hljs-string">'check'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;
    }
),
</code>
</pre>

            <p>После этого создадим два метода. Один для принимания заппросов по GET методу, второй — методом POST.<br>
            Допишем в TableAdminController.php (создадим и допишем, если его нету, ага):</p>
            <p class="alert alert-warning">Желательно хранить все такие методы в одном конроллере, чтобы не разбрасывать однообразную логику по всему приложению.</p>
<pre><code class="php hljs">
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showProducts</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-variable">$options</span> = <span class="hljs-keyword">array</span>(
        <span class="hljs-comment">// обязательное поле: uri по которому идет отображение страницы</span>
        <span class="hljs-string">'url'</span>      =&gt; <span class="hljs-string">'/admin/products'</span>, 
        <span class="hljs-comment">// обязательное поле: название описания, по которому строится таблица</span>
        <span class="hljs-comment">// в этом варианте подтянется описание по пути app/tb-definitions/products.php</span>
        <span class="hljs-string">'def_name'</span> =&gt; <span class="hljs-string">'products'</span>,        
    );
    <span class="hljs-keyword">list</span>(<span class="hljs-variable">$table</span>, <span class="hljs-variable">$form</span>) = TableBuilder::create(<span class="hljs-variable">$options</span>);

    <span class="hljs-variable">$view</span> = View::make(<span class="hljs-string">'admin::table'</span>, compact(<span class="hljs-string">'table'</span>, <span class="hljs-string">'form'</span>));

    <span class="hljs-keyword">return</span> <span class="hljs-variable">$view</span>;
} <span class="hljs-comment">// end showProducts</span>

<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleProducts</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-variable">$options</span> = <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'url'</span>      =&gt; <span class="hljs-string">'/admin/products'</span>,
        <span class="hljs-string">'def_name'</span> =&gt; <span class="hljs-string">'products'</span>,
    );
    
    <span class="hljs-keyword">return</span> TableBuilder::create(<span class="hljs-variable">$options</span>);
} <span class="hljs-comment">// end handleProducts  </span>
</code>
</pre>                
  
            <p>Пропишем роуты для наших двух методов:</p>      
<pre><code class="php hljs">
Route::group(<span class="hljs-keyword">array</span>(<span class="hljs-string">'prefix'</span> =&gt; <span class="hljs-string">'admin'</span>, <span class="hljs-string">'before'</span> =&gt; <span class="hljs-keyword">array</span>(<span class="hljs-string">'auth_admin'</span>, <span class="hljs-string">'check_permissions'</span>)), <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    Route::get(<span class="hljs-string">'/products'</span>, <span class="hljs-string">'TableAdminController@showProducts'</span>);
    Route::post(<span class="hljs-string">'/handle/products'</span>, <span class="hljs-string">'TableAdminController@handleProducts'</span>);
});
</code>
</pre>  
        
            <p>И, наконец-то, создадим наше описание таблицы. Они хранятся в директории <code>app/tb-definitions</code>.<br>
               Создаем в нем <code>products.php</code> со следующим содержанием:</p>   
<pre><code class="php hljs">
<span class="hljs-keyword">return</span> <span class="hljs-keyword">array</span>(
    <span class="hljs-string">'db'</span> =&gt; <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'table'</span> =&gt; <span class="hljs-string">'products'</span>,
        <span class="hljs-string">'order'</span> =&gt; <span class="hljs-keyword">array</span>(
            <span class="hljs-string">'id'</span> =&gt; <span class="hljs-string">'DESC'</span>,
        ),
        <span class="hljs-string">'pagination'</span> =&gt; <span class="hljs-keyword">array</span>(
            <span class="hljs-string">'per_page'</span> =&gt; <span class="hljs-number">20</span>,
            <span class="hljs-string">'uri'</span> =&gt; <span class="hljs-string">'/admin/products'</span>,
        ),
    ),
    <span class="hljs-string">'options'</span> =&gt; <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'caption'</span> =&gt; <span class="hljs-string">'Товары'</span>,
        <span class="hljs-string">'ident'</span> =&gt; <span class="hljs-string">'products-container'</span>,
        <span class="hljs-string">'form_ident'</span> =&gt; <span class="hljs-string">'products-form'</span>,
        <span class="hljs-string">'table_ident'</span> =&gt; <span class="hljs-string">'products-table'</span>,
        <span class="hljs-string">'action_url'</span> =&gt; <span class="hljs-string">'/admin/handle/products'</span>,
        <span class="hljs-string">'not_found'</span> =&gt; <span class="hljs-string">'NOT FOUND'</span>,
    ),
    <span class="hljs-string">'fields'</span> =&gt; <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'id'</span> =&gt; <span class="hljs-keyword">array</span>(
            <span class="hljs-string">'caption'</span> =&gt; <span class="hljs-string">'#'</span>,
            <span class="hljs-string">'type'</span> =&gt; <span class="hljs-string">'readonly'</span>,
            <span class="hljs-string">'class'</span> =&gt; <span class="hljs-string">'col-id'</span>,
            <span class="hljs-string">'width'</span> =&gt; <span class="hljs-string">'1%'</span>,
            <span class="hljs-string">'hide'</span> =&gt; <span class="hljs-keyword">true</span>,
            <span class="hljs-string">'filter'</span> =&gt; <span class="hljs-string">'text'</span>,
            <span class="hljs-string">'is_sorting'</span> =&gt; <span class="hljs-keyword">true</span>
        ),
        <span class="hljs-string">'name'</span> =&gt; <span class="hljs-keyword">array</span>(
            <span class="hljs-string">'caption'</span> =&gt; <span class="hljs-string">'Название'</span>,
            <span class="hljs-string">'type'</span> =&gt; <span class="hljs-string">'text'</span>,
            <span class="hljs-string">'filter'</span> =&gt; <span class="hljs-string">'text'</span>,
            <span class="hljs-string">'is_sorting'</span> =&gt; <span class="hljs-keyword">true</span>
        ),
        <span class="hljs-string">'price'</span> =&gt; <span class="hljs-keyword">array</span>(
            <span class="hljs-string">'caption'</span> =&gt; <span class="hljs-string">'Цена'</span>,
            <span class="hljs-string">'type'</span> =&gt; <span class="hljs-string">'text'</span>,
            <span class="hljs-string">'filter'</span> =&gt; <span class="hljs-string">'text'</span>,
            <span class="hljs-string">'is_sorting'</span> =&gt; <span class="hljs-keyword">true</span>
        ),
        <span class="hljs-string">'is_active'</span> =&gt; <span class="hljs-keyword">array</span>(
            <span class="hljs-string">'caption'</span> =&gt; <span class="hljs-string">'Товар активен'</span>,
            <span class="hljs-string">'type'</span> =&gt; <span class="hljs-string">'checkbox'</span>,
            <span class="hljs-string">'filter'</span> =&gt; <span class="hljs-string">'select'</span>,
            <span class="hljs-string">'options'</span> =&gt; <span class="hljs-keyword">array</span>(
                <span class="hljs-number">1</span> =&gt; <span class="hljs-string">'Активные'</span>,
                <span class="hljs-number">0</span> =&gt; <span class="hljs-string">'He aктивные'</span>,
            ),
        ),
    ),
    <span class="hljs-string">'filters'</span> =&gt; <span class="hljs-keyword">array</span>(
    ),
    <span class="hljs-string">'actions'</span> =&gt; <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'search'</span> =&gt; <span class="hljs-keyword">array</span>(
            <span class="hljs-string">'caption'</span> =&gt; <span class="hljs-string">'Поиск'</span>,
        ),
        <span class="hljs-string">'insert'</span> =&gt; <span class="hljs-keyword">array</span>(
            <span class="hljs-string">'caption'</span> =&gt; <span class="hljs-string">'Добавить'</span>,
            <span class="hljs-string">'check'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;
            }
        ),
        <span class="hljs-string">'update'</span> =&gt; <span class="hljs-keyword">array</span>(
            <span class="hljs-string">'caption'</span> =&gt; <span class="hljs-string">'Update'</span>,
            <span class="hljs-string">'check'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;
            }
        ),
        <span class="hljs-string">'delete'</span> =&gt; <span class="hljs-keyword">array</span>(
            <span class="hljs-string">'caption'</span> =&gt; <span class="hljs-string">'Remove'</span>,
            <span class="hljs-string">'check'</span> =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;
            }
        ),
    ),
    
);
</code>
</pre>  
        <p class="alert alert-info">Описание построения можно почитать в соседнем табе.</p>

        <p>Теперь перейдем по ссылке <code>/admin/products</code> и насладимся таблицей.<br>
           Мои поздравления! Вы восхитительны.</p>

</div>    </div>
    <div class="tab-pane " id="mmmm">
        <dl>
  <dt class="text-primary">Как передать в описание таблицы свои значения?</dt>
  <dd>
    При создании таблицы нужно передать опцию <code>additional</code>, содержимое которой будет доступно в переменной <code>$options</code> внутри описания.
<pre><code class="php hljs">            
<span class="hljs-variable">$options</span> = <span class="hljs-keyword">array</span>(
    <span class="hljs-comment">// ...</span>
    <span class="hljs-string">'additional'</span> =&gt; <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'var'</span> =&gt; <span class="hljs-string">'some'</span>
    )
);
<span class="hljs-keyword">list</span>(<span class="hljs-variable">$table</span>, <span class="hljs-variable">$form</span>) = TableBuilder::create(<span class="hljs-variable">$options</span>);
</code>
</pre>  
  </dd>
  
</dl>    </div>
</div>






</div>
<div class="well well-sm">
<h3 class="text-primary">Файловый менеджер:</h3>
                    

<p>Обычный файловый менеджер. Вызов соответствующего метода через фасад возвращает все необходимое для его отображения:</p>

<pre><code class="php hljs">
<span class="hljs-variable">$content</span> = TableBuilder::fileManager(<span class="hljs-variable">$connectorUrl</span>);

<span class="hljs-keyword">return</span> View::make(<span class="hljs-string">'admin::file_manager'</span>, compact(<span class="hljs-string">'content'</span>));
</code>
</pre>


<dl class="dl-horizontal">
  <dt>$connectorUrl</dt>
  <dd>Ссылка на коннектор файлового менеджера.  <span class="label bg-color-blueLight pull-right">/tb/elfinder/connector</span>
  </dd>
</dl>

<hr>
<p>Как должен выглядеть метод, к которому идет обращение по ссылке (в примере описан дефолтный):</p>

<pre><code class="php hljs">
<span class="hljs-variable">$dir</span> = Config::get(<span class="hljs-string">'laravel-elfinder::dir'</span>);
<span class="hljs-variable">$roots</span> = Config::get(<span class="hljs-string">'laravel-elfinder::roots'</span>);
<span class="hljs-keyword">if</span> (!<span class="hljs-variable">$roots</span>) {
    <span class="hljs-variable">$roots</span> = <span class="hljs-keyword">array</span>(
        <span class="hljs-keyword">array</span>(
            <span class="hljs-string">'driver'</span> =&gt; <span class="hljs-string">'LocalFileSystem'</span>, <span class="hljs-comment">// драйвер для доступа к файловой системе (обязательно)</span>
            <span class="hljs-string">'path'</span> =&gt; public_path() . DIRECTORY_SEPARATOR . <span class="hljs-variable">$dir</span>, <span class="hljs-comment">// путь к файлам (обязательно)</span>
            <span class="hljs-string">'URL'</span> =&gt; asset(<span class="hljs-variable">$dir</span>), <span class="hljs-comment">// ссылка на файлы (обязательно)</span>
            <span class="hljs-string">'accessControl'</span> =&gt; Config::get(<span class="hljs-string">'laravel-elfinder::access'</span>) <span class="hljs-comment">// коллбек для фльтрации (опционально)</span>
        )
    );
}

<span class="hljs-comment">// Документация опций коннектора:</span>
<span class="hljs-comment">// https://github.com/Studio-42/elFinder/wiki/Connector-configuration-options</span>
<span class="hljs-variable">$opts</span> = <span class="hljs-keyword">array</span>(
    <span class="hljs-string">'roots'</span> =&gt; <span class="hljs-variable">$roots</span>
);

<span class="hljs-variable">$connector</span> = <span class="hljs-keyword">new</span> \elFinderConnector(<span class="hljs-keyword">new</span> \elFinder(<span class="hljs-variable">$opts</span>));
<span class="hljs-keyword">return</span> Response::stream(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> <span class="hljs-title">use</span><span class="hljs-params">(<span class="hljs-variable">$connector</span>)</span> </span>{
    <span class="hljs-variable">$connector</span>-&gt;run();
});
</code>
</pre>

</div>


<div class="well well-sm">
<h3 class="text-primary">И не костыляем, бозоны, ато АТАТА!!</h3>
                    

<div style="text-align: center;">
    <img src="http://php.net/manual/en/images/0baa1b9fae6aec55bbb73037f3016001-xkcd-goto.png">
</div>     


</div>




</div>
      
      
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

  </body>
</html>
